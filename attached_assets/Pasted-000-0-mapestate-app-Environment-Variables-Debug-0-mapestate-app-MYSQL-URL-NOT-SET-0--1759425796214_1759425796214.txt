000
0|mapestate-app  | 🔍 Environment Variables Debug:
0|mapestate-app  |    MYSQL_URL: [NOT SET]
0|mapestate-app  |    MYSQL_HOST: [SET]
0|mapestate-app  |    MYSQL_USER: [SET]
0|mapestate-app  |    MYSQL_DATABASE: [SET]
0|mapestate-app  |    MYSQL_PORT: 3306
0|mapestate-app  |    MYSQL_PASSWORD: [SET]
0|mapestate-app  | 🔗 Using MySQL VPS configuration from environment variables
0|mapestate-app  | 🔧 MySQL VPS: mysql://mapestate:***@localhost:3306/mapestate
0|mapestate-app  | 🔗 Database configuration:
0|mapestate-app  |    Host: localhost:3306
0|mapestate-app  |    User: mapestate
0|mapestate-app  |    Database: mapestate
0|mapestate-app  | 🔄 Connecting to MySQL VPS database...
0|mapestate-app  | ✅ MySQL VPS connection established successfully
0|mapestate-app  | 🔍 Testing database connection...
0|mapestate-app  | 💓 Database connection is healthy
0|mapestate-app  | ✅ MySQL database initialized successfully
0|mapestate-app  | 🔗 Using MySQL DatabaseStorage
0|mapestate-app  | 🔧 Running startup fix for user language permissions...
0|mapestate-app  | 🔧 Fixing existing users language permissions...
0|mapestate-app  | Found 0 regular users to fix
0|mapestate-app  | ✅ Finished fixing existing users language permissions
0|mapestate-app  | Warning: connect.session() MemoryStore is not
0|mapestate-app  | designed for a production environment, as it will leak
0|mapestate-app  | memory, and will not scale past a single process.
0|mapestate-app  | 📁 Serving uploads from: /root/dailynewscrypto.net/server/uploads
0|mapestate-app  | 4:55:11 PM [express] serving on port 5000
^C
root@srv1027249:~/dailynewscrypto.net# git fetch origin
git reset --hard origin/main
npm install
npm run build
pm2 restart all
HEAD is now at 3334813 Automatically detect image server URL from incoming requests

up to date, audited 574 packages in 1s

83 packages are looking for funding
  run `npm fund` for details

7 vulnerabilities (1 low, 6 moderate)

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.

> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.19 building for production...
✓ 2716 modules transformed.
../dist/public/index.html                                                   5.76 kB │ gzip:   1.89 kB
../dist/public/assets/logo_1757848527935-f97yEqP4.png                      34.60 kB
../dist/public/assets/UniQAIDAR_Asiacell 001_1758107005933-Cl-Cqdhv.ttf    57.23 kB
../dist/public/assets/UniQAIDAR_Asiacell 002_1758107005922-ClO-zV7t.ttf    57.24 kB
../dist/public/assets/US_flag_circular_design_55844ad0-B0cUOQ6G.png       506.88 kB
../dist/public/assets/Saudi_flag_circular_design_3c46c604-D1J1e9j5.png    518.22 kB
../dist/public/assets/Kurdish_flag_circular_design_55e28463-qI8fKU0i.png  529.54 kB
../dist/public/assets/index-DB3P6AH3.css                                  129.06 kB │ gzip:  20.43 kB
../dist/public/assets/filter-PZMHiNll.js                                    0.33 kB │ gzip:   0.26 kB
../dist/public/assets/arrow-left-CDErPK_U.js                                0.33 kB │ gzip:   0.27 kB
../dist/public/assets/search-B0__l0wf.js                                    0.34 kB │ gzip:   0.27 kB
../dist/public/assets/user-BRMPxHot.js                                      0.37 kB │ gzip:   0.28 kB
../dist/public/assets/dollar-sign-CzNd3XeV.js                               0.39 kB │ gzip:   0.30 kB
../dist/public/assets/heart-HZtzyPyg.js                                     0.41 kB │ gzip:   0.31 kB
../dist/public/assets/globe-BzEdP_o2.js                                     0.41 kB │ gzip:   0.29 kB
../dist/public/assets/circle-alert-Y0h3TZH0.js                              0.42 kB │ gzip:   0.29 kB
../dist/public/assets/map-pin-DTZuG_bG.js                                   0.42 kB │ gzip:   0.32 kB
../dist/public/assets/calendar-DyI40eqw.js                                  0.43 kB │ gzip:   0.30 kB
../dist/public/assets/chart-pie-C8NtOpSv.js                                 0.44 kB │ gzip:   0.32 kB
../dist/public/assets/shield-D7KSCCVT.js                                    0.44 kB │ gzip:   0.33 kB
../dist/public/assets/award-OrQydrf5.js                                     0.44 kB │ gzip:   0.33 kB
../dist/public/assets/lightbulb-CbE4beTf.js                                 0.46 kB │ gzip:   0.33 kB
../dist/public/assets/users-DRUZ7Zse.js                                     0.47 kB │ gzip:   0.32 kB
../dist/public/assets/phone-DIIjAq4T.js                                     0.56 kB │ gzip:   0.36 kB
../dist/public/assets/input-CEXP3Dsu.js                                     0.58 kB │ gzip:   0.35 kB
../dist/public/assets/eye-off-Cmb9t00B.js                                   0.60 kB │ gzip:   0.38 kB
../dist/public/assets/not-found-BCBho8H9.js                                 0.67 kB │ gzip:   0.38 kB
../dist/public/assets/separator-CMS0_aEz.js                                 0.67 kB │ gzip:   0.40 kB
../dist/public/assets/badge-ixHLGhen.js                                     0.71 kB │ gzip:   0.37 kB
../dist/public/assets/dashboard-redirect-BSdM-6F3.js                        0.74 kB │ gzip:   0.44 kB
../dist/public/assets/key-DSNGRiZU.js                                       0.84 kB │ gzip:   0.42 kB
../dist/public/assets/label-B69qZPXN.js                                     0.93 kB │ gzip:   0.60 kB
../dist/public/assets/bed-CweIxFYY.js                                       0.94 kB │ gzip:   0.44 kB
../dist/public/assets/card-BOi6fvo7.js                                      0.99 kB │ gzip:   0.36 kB
../dist/public/assets/use-local-favorites-tbfPXXzn.js                       1.36 kB │ gzip:   0.61 kB
../dist/public/assets/tag-BwWXodYX.js                                       1.41 kB │ gzip:   0.55 kB
../dist/public/assets/optimized-image-BjyTl3Eo.js                           2.21 kB │ gzip:   1.15 kB
../dist/public/assets/avatar-Dq2oKY0T.js                                    2.46 kB │ gzip:   1.18 kB
../dist/public/assets/use-properties-xhxCngDl.js                            2.67 kB │ gzip:   0.92 kB
../dist/public/assets/index-Bs6N3c5u.js                                     3.38 kB │ gzip:   1.54 kB
../dist/public/assets/favorites-Cw0gOZ76.js                                 3.51 kB │ gzip:   1.44 kB
../dist/public/assets/location-selection-map-B00Mwv-1.js                    3.76 kB │ gzip:   1.77 kB
../dist/public/assets/admin-login-CHZahOL9.js                               4.88 kB │ gzip:   1.83 kB
../dist/public/assets/usePropertyEvents-CeGEu9wF.js                         5.73 kB │ gzip:   1.83 kB
../dist/public/assets/property-card-CBH4Lkv5.js                             7.31 kB │ gzip:   2.76 kB
../dist/public/assets/about-IMa9Pctw.js                                     8.50 kB │ gzip:   2.01 kB
../dist/public/assets/dialog-CscdNu8G.js                                   11.29 kB │ gzip:   3.94 kB
../dist/public/assets/settings-C7iSxm9O.js                                 13.22 kB │ gzip:   3.71 kB
../dist/public/assets/meta-enhancement-C9nU5ZXP.js                         14.36 kB │ gzip:   5.74 kB
../dist/public/assets/typography-showcase-fIBIOtg_.js                      14.36 kB │ gzip:   2.85 kB
../dist/public/assets/properties-Cu1N1jFZ.js                               14.71 kB │ gzip:   4.01 kB
../dist/public/assets/Combination-Fordj0O9.js                              16.93 kB │ gzip:   6.47 kB
../dist/public/assets/SEOHead-Cw0REGzI.js                                  19.84 kB │ gzip:   7.20 kB
../dist/public/assets/home-D25_kKgL.js                                     20.01 kB │ gzip:   5.47 kB
../dist/public/assets/dropdown-menu-CBzHjo-W.js                            21.26 kB │ gzip:   6.27 kB
../dist/public/assets/select-CSPF9Ab-.js                                   21.80 kB │ gzip:   7.61 kB
../dist/public/assets/property-detail-sMUIReYz.js                          32.76 kB │ gzip:   9.62 kB
../dist/public/assets/property-map-Co_PSN4J.js                             47.15 kB │ gzip:  12.45 kB
../dist/public/assets/index-Cm4iEZ7Q.js                                    88.91 kB │ gzip:  24.81 kB
../dist/public/assets/admin-dashboard-BmgzwElm.js                          91.42 kB │ gzip:  20.37 kB
../dist/public/assets/customer-dashboard-DHzAzMxd.js                       97.55 kB │ gzip:  23.74 kB
../dist/public/assets/client-location-tracking-BXyNoO5u.js                195.56 kB │ gzip:  66.42 kB
../dist/public/assets/index-Dff1B840.js                                   317.74 kB │ gzip: 105.92 kB
../dist/public/assets/PieChart-BiU8YmNQ.js                                442.42 kB │ gzip: 119.36 kB
✓ built in 13.91s

  dist/index.js  201.5kb

⚡ Done in 19ms
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [all](ids: [ 0, 1 ])
[PM2] [mapestate-app](0) ✓
[PM2] [mapestate](1) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 1  │ mapestate          │ cluster  │ 2    │ online    │ 0%       │ 40.3mb   │
│ 0  │ mapestate-app      │ fork     │ 55   │ online    │ 0%       │ 57.3mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
root@srv1027249:~/dailynewscrypto.net# # Connect to MySQL
mysql -u mapestate -p
# Enter password: Mapestate123!
Enter password: 
ERROR 1045 (28000): Access denied for user 'mapestate'@'localhost' (using password: YES)
root@srv1027249:~/dailynewscrypto.net# mysql -u mapestate -p
Enter password: 
ERROR 1045 (28000): Access denied for user 'mapestate'@'localhost' (using password: YES)
root@srv1027249:~/dailynewscrypto.net# mysql -u mapestate -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 29
Server version: 8.0.43-0ubuntu0.24.04.2 (Ubuntu)

Copyright (c) 2000, 2025, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> USE mapestate;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> 
mysql> -- Check if users exist
mysql> SELECT username, email, role FROM users;
+------------+---------------------------+-------------+
| username   | email                     | role        |
+------------+---------------------------+-------------+
| admin      | admin@mapestate.com       | admin       |
| admin2     | admin@dailynewscrypto.net | super_admin |
| john_agent | john@estateai.com         | agent       |
+------------+---------------------------+-------------+
3 rows in set (0.00 sec)

mysql> 
mysql> -- If no users exist, or if admin doesn't exist, create it manually:
mysql> INSERT INTO users (id, username, email, password, role, firstName, lastName, phone, isVerified, createdAt)
    -> VALUES (
    ->   UUID(),
    ->   'admin',
    ->   'admin@estateai.com',
    ->   '$2b$12$LQv3c1yqBwDV.FPdwL4uX.YxM8LgVZhXz3jY9vW8qJ2pQGKVJQK9K',
    ->   'super_admin',
    ->   'System',
    ->   'Admin',
    ->   '+964 750 000 0000',
    ->   true,
    ->   NOW()
    -> );
ERROR 1054 (42S22): Unknown column 'firstName' in 'field list'
mysql> 
mysql> -- Verify it was created
mysql> SELECT username, email, role FROM users WHERE username = 'admin';
+----------+---------------------+-------+
| username | email               | role  |
+----------+---------------------+-------+
| admin    | admin@mapestate.com | admin |
+----------+---------------------+-------+
1 row in set (0.00 sec)

mysql> 
mysql> exit
Bye
root@srv1027249:~/dailynewscrypto.net# cd ~/dailynewscrypto.net

# Push the schema changes to MySQL
npm run db:push

> rest-express@1.0.0 db:push
> drizzle-kit push

No config path provided, using default 'drizzle.config.ts'
Reading config file '/root/dailynewscrypto.net/drizzle.config.ts'
DATABASE_URL, ensure the database is provisioned
root@srv1027249:~/dailynewscrypto.net# npm run db:push -- --force

> rest-express@1.0.0 db:push
> drizzle-kit push --force

No config path provided, using default 'drizzle.config.ts'
Reading config file '/root/dailynewscrypto.net/drizzle.config.ts'
DATABASE_URL, ensure the database is provisioned
root@srv1027249:~/dailynewscrypto.net# mysql -u mapestate -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 30
Server version: 8.0.43-0ubuntu0.24.04.2 (Ubuntu)

Copyright (c) 2000, 2025, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> USE mapestate;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> 
mysql> -- Update admin user's password to the hashed version of "admin123"
mysql> UPDATE users 
    -> SET password = '$2b$12$LQv3c1yqBwDV.FPdwL4uX.YxM8LgVZhXz3jY9vW8qJ2pQGKVJQK9K'
    -> WHERE username = 'admin';
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> cd ~/dailynewscrypto.net
    -> 
    -> # 1. Remove the conflicting file
    -> rm mapestate-database.sql
    -> 
    -> # 2. Pull the latest code
    -> git pull origin main
    -> 
    -> # 3. Update the database schema to match the code
    -> npm run db:push
    -> 
    -> # If it warns about data loss, force it:
    -> # npm run db:push -- --force
    -> 
    -> # 4. Rebuild the application
    -> npm run build
    -> 
    -> # 5. Restart PM2
    -> pm2 restart all
    -> 
    -> # 6. Check the logs
    -> pm2 logs --lines 30
    -> ç^C
mysql> exit
Bye
root@srv1027249:~/dailynewscrypto.net# cd ~/dailynewscrypto.net

# 1. Remove the conflicting file
rm mapestate-database.sql

# 2. Pull the latest code
git pull origin main

# 3. Update the database schema to match the code
npm run db:push

# If it warns about data loss, force it:
# npm run db:push -- --force

# 4. Rebuild the application
npm run build

# 5. Restart PM2
pm2 restart all

# 6. Check the logs
pm2 logs --lines 30
From https://github.com/roottgroup-gif/AIMRealty-1
 * branch            main       -> FETCH_HEAD
Already up to date.

> rest-express@1.0.0 db:push
> drizzle-kit push

No config path provided, using default 'drizzle.config.ts'
Reading config file '/root/dailynewscrypto.net/drizzle.config.ts'
DATABASE_URL, ensure the database is provisioned

> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.19 building for production...
✓ 2716 modules transformed.
../dist/public/index.html                                                   5.76 kB │ gzip:   1.89 kB
../dist/public/assets/logo_1757848527935-f97yEqP4.png                      34.60 kB
../dist/public/assets/UniQAIDAR_Asiacell 001_1758107005933-Cl-Cqdhv.ttf    57.23 kB
../dist/public/assets/UniQAIDAR_Asiacell 002_1758107005922-ClO-zV7t.ttf    57.24 kB
../dist/public/assets/US_flag_circular_design_55844ad0-B0cUOQ6G.png       506.88 kB
../dist/public/assets/Saudi_flag_circular_design_3c46c604-D1J1e9j5.png    518.22 kB
../dist/public/assets/Kurdish_flag_circular_design_55e28463-qI8fKU0i.png  529.54 kB
../dist/public/assets/index-DB3P6AH3.css                                  129.06 kB │ gzip:  20.43 kB
../dist/public/assets/filter-PZMHiNll.js                                    0.33 kB │ gzip:   0.26 kB
../dist/public/assets/arrow-left-CDErPK_U.js                                0.33 kB │ gzip:   0.27 kB
../dist/public/assets/search-B0__l0wf.js                                    0.34 kB │ gzip:   0.27 kB
../dist/public/assets/user-BRMPxHot.js                                      0.37 kB │ gzip:   0.28 kB
../dist/public/assets/dollar-sign-CzNd3XeV.js                               0.39 kB │ gzip:   0.30 kB
../dist/public/assets/heart-HZtzyPyg.js                                     0.41 kB │ gzip:   0.31 kB
../dist/public/assets/globe-BzEdP_o2.js                                     0.41 kB │ gzip:   0.29 kB
../dist/public/assets/circle-alert-Y0h3TZH0.js                              0.42 kB │ gzip:   0.29 kB
../dist/public/assets/map-pin-DTZuG_bG.js                                   0.42 kB │ gzip:   0.32 kB
../dist/public/assets/calendar-DyI40eqw.js                                  0.43 kB │ gzip:   0.30 kB
../dist/public/assets/chart-pie-C8NtOpSv.js                                 0.44 kB │ gzip:   0.32 kB
../dist/public/assets/shield-D7KSCCVT.js                                    0.44 kB │ gzip:   0.33 kB
../dist/public/assets/award-OrQydrf5.js                                     0.44 kB │ gzip:   0.33 kB
../dist/public/assets/lightbulb-CbE4beTf.js                                 0.46 kB │ gzip:   0.33 kB
../dist/public/assets/users-DRUZ7Zse.js                                     0.47 kB │ gzip:   0.32 kB
../dist/public/assets/phone-DIIjAq4T.js                                     0.56 kB │ gzip:   0.36 kB
../dist/public/assets/input-CEXP3Dsu.js                                     0.58 kB │ gzip:   0.35 kB
../dist/public/assets/eye-off-Cmb9t00B.js                                   0.60 kB │ gzip:   0.38 kB
../dist/public/assets/not-found-BCBho8H9.js                                 0.67 kB │ gzip:   0.38 kB
../dist/public/assets/separator-CMS0_aEz.js                                 0.67 kB │ gzip:   0.40 kB
../dist/public/assets/badge-ixHLGhen.js                                     0.71 kB │ gzip:   0.37 kB
../dist/public/assets/dashboard-redirect-BSdM-6F3.js                        0.74 kB │ gzip:   0.44 kB
../dist/public/assets/key-DSNGRiZU.js                                       0.84 kB │ gzip:   0.42 kB
../dist/public/assets/label-B69qZPXN.js                                     0.93 kB │ gzip:   0.60 kB
../dist/public/assets/bed-CweIxFYY.js                                       0.94 kB │ gzip:   0.44 kB
../dist/public/assets/card-BOi6fvo7.js                                      0.99 kB │ gzip:   0.36 kB
../dist/public/assets/use-local-favorites-tbfPXXzn.js                       1.36 kB │ gzip:   0.61 kB
../dist/public/assets/tag-BwWXodYX.js                                       1.41 kB │ gzip:   0.55 kB
../dist/public/assets/optimized-image-BjyTl3Eo.js                           2.21 kB │ gzip:   1.15 kB
../dist/public/assets/avatar-Dq2oKY0T.js                                    2.46 kB │ gzip:   1.18 kB
../dist/public/assets/use-properties-xhxCngDl.js                            2.67 kB │ gzip:   0.92 kB
../dist/public/assets/index-Bs6N3c5u.js                                     3.38 kB │ gzip:   1.54 kB
../dist/public/assets/favorites-Cw0gOZ76.js                                 3.51 kB │ gzip:   1.44 kB
../dist/public/assets/location-selection-map-B00Mwv-1.js                    3.76 kB │ gzip:   1.77 kB
../dist/public/assets/admin-login-CHZahOL9.js                               4.88 kB │ gzip:   1.83 kB
../dist/public/assets/usePropertyEvents-CeGEu9wF.js                         5.73 kB │ gzip:   1.83 kB
../dist/public/assets/property-card-CBH4Lkv5.js                             7.31 kB │ gzip:   2.76 kB
../dist/public/assets/about-IMa9Pctw.js                                     8.50 kB │ gzip:   2.01 kB
../dist/public/assets/dialog-CscdNu8G.js                                   11.29 kB │ gzip:   3.94 kB
../dist/public/assets/settings-C7iSxm9O.js                                 13.22 kB │ gzip:   3.71 kB
../dist/public/assets/meta-enhancement-C9nU5ZXP.js                         14.36 kB │ gzip:   5.74 kB
../dist/public/assets/typography-showcase-fIBIOtg_.js                      14.36 kB │ gzip:   2.85 kB
../dist/public/assets/properties-Cu1N1jFZ.js                               14.71 kB │ gzip:   4.01 kB
../dist/public/assets/Combination-Fordj0O9.js                              16.93 kB │ gzip:   6.47 kB
../dist/public/assets/SEOHead-Cw0REGzI.js                                  19.84 kB │ gzip:   7.20 kB
../dist/public/assets/home-D25_kKgL.js                                     20.01 kB │ gzip:   5.47 kB
../dist/public/assets/dropdown-menu-CBzHjo-W.js                            21.26 kB │ gzip:   6.27 kB
../dist/public/assets/select-CSPF9Ab-.js                                   21.80 kB │ gzip:   7.61 kB
../dist/public/assets/property-detail-sMUIReYz.js                          32.76 kB │ gzip:   9.62 kB
../dist/public/assets/property-map-Co_PSN4J.js                             47.15 kB │ gzip:  12.45 kB
../dist/public/assets/index-Cm4iEZ7Q.js                                    88.91 kB │ gzip:  24.81 kB
../dist/public/assets/admin-dashboard-BmgzwElm.js                          91.42 kB │ gzip:  20.37 kB
../dist/public/assets/customer-dashboard-DHzAzMxd.js                       97.55 kB │ gzip:  23.74 kB
../dist/public/assets/client-location-tracking-BXyNoO5u.js                195.56 kB │ gzip:  66.42 kB
../dist/public/assets/index-Dff1B840.js                                   317.74 kB │ gzip: 105.92 kB
../dist/public/assets/PieChart-BiU8YmNQ.js                                442.42 kB │ gzip: 119.36 kB
✓ built in 13.43s

  dist/index.js  201.5kb

⚡ Done in 21ms
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [all](ids: [ 0, 1 ])
[PM2] [mapestate-app](0) ✓
[PM2] [mapestate](1) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 1  │ mapestate          │ cluster  │ 3    │ online    │ 0%       │ 40.3mb   │
│ 0  │ mapestate-app      │ fork     │ 56   │ online    │ 0%       │ 57.2mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[TAILING] Tailing last 30 lines for [all] processes (change the value with --lines option)
/root/.pm2/pm2.log last 30 lines:
PM2        | 2025-10-02T16:54:53: PM2 log: Stopping app:mapestate id:1
PM2        | 2025-10-02T16:54:53: PM2 log: App name:mapestate id:1 disconnected
PM2        | 2025-10-02T16:54:53: PM2 log: App [mapestate:1] exited with code [0] via signal [SIGINT]
PM2        | 2025-10-02T16:54:53: PM2 log: pid=20855 msg=process killed
PM2        | 2025-10-02T16:55:09: PM2 log: App [mapestate-app:0] starting in -fork mode-
PM2        | 2025-10-02T16:55:09: PM2 log: App [mapestate-app:0] online
PM2        | 2025-10-02T16:55:09: PM2 log: App [mapestate:1] starting in -cluster mode-
PM2        | 2025-10-02T16:55:09: PM2 log: App [mapestate:1] online
PM2        | 2025-10-02T16:55:34: PM2 log: Stopping app:mapestate-app id:0
PM2        | 2025-10-02T16:55:34: PM2 log: App [mapestate-app:0] exited with code [0] via signal [SIGINT]
PM2        | 2025-10-02T16:55:34: PM2 log: pid=21008 msg=process killed
PM2        | 2025-10-02T16:55:34: PM2 log: App [mapestate-app:0] starting in -fork mode-
PM2        | 2025-10-02T16:55:34: PM2 log: App [mapestate-app:0] online
PM2        | 2025-10-02T16:55:34: PM2 log: Stopping app:mapestate id:1
PM2        | 2025-10-02T16:55:34: PM2 log: App name:mapestate id:1 disconnected
PM2        | 2025-10-02T16:55:34: PM2 log: App [mapestate:1] exited with code [0] via signal [SIGINT]
PM2        | 2025-10-02T16:55:34: PM2 log: pid=21009 msg=process killed
PM2        | 2025-10-02T16:55:34: PM2 log: App [mapestate:1] starting in -cluster mode-
PM2        | 2025-10-02T16:55:34: PM2 log: App [mapestate:1] online
PM2        | 2025-10-02T17:01:42: PM2 log: Stopping app:mapestate-app id:0
PM2        | 2025-10-02T17:01:42: PM2 log: App [mapestate-app:0] exited with code [0] via signal [SIGINT]
PM2        | 2025-10-02T17:01:42: PM2 log: pid=21134 msg=process killed
PM2        | 2025-10-02T17:01:42: PM2 log: App [mapestate-app:0] starting in -fork mode-
PM2        | 2025-10-02T17:01:42: PM2 log: App [mapestate-app:0] online
PM2        | 2025-10-02T17:01:42: PM2 log: Stopping app:mapestate id:1
PM2        | 2025-10-02T17:01:42: PM2 log: App name:mapestate id:1 disconnected
PM2        | 2025-10-02T17:01:42: PM2 log: App [mapestate:1] exited with code [0] via signal [SIGINT]
PM2        | 2025-10-02T17:01:42: PM2 log: pid=21146 msg=process killed
PM2        | 2025-10-02T17:01:42: PM2 log: App [mapestate:1] starting in -cluster mode-
PM2        | 2025-10-02T17:01:42: PM2 log: App [mapestate:1] online

/root/.pm2/logs/mapestate-error-1.log last 30 lines:
1|mapestat | Warning: connect.session() MemoryStore is not
1|mapestat | designed for a production environment, as it will leak
1|mapestat | memory, and will not scale past a single process.
1|mapestat | Warning: connect.session() MemoryStore is not
1|mapestat | designed for a production environment, as it will leak
1|mapestat | memory, and will not scale past a single process.
1|mapestat | Warning: connect.session() MemoryStore is not
1|mapestat | designed for a production environment, as it will leak
1|mapestat | memory, and will not scale past a single process.
1|mapestat | Warning: connect.session() MemoryStore is not
1|mapestat | designed for a production environment, as it will leak
1|mapestat | memory, and will not scale past a single process.
1|mapestat | Warning: connect.session() MemoryStore is not
1|mapestat | designed for a production environment, as it will leak
1|mapestat | memory, and will not scale past a single process.
1|mapestat | Warning: connect.session() MemoryStore is not
1|mapestat | designed for a production environment, as it will leak
1|mapestat | memory, and will not scale past a single process.

/root/.pm2/logs/mapestate-out-1.log last 30 lines:
1|mapestat | Found 0 regular users to fix
1|mapestat | ✅ Finished fixing existing users language permissions
1|mapestat | 📁 Serving uploads from: /root/dailynewscrypto.net/server/uploads
1|mapestat | 4:55:10 PM [express] serving on port 3000
1|mapestat | 🔍 Environment Variables Debug:
1|mapestat |    MYSQL_URL: [NOT SET]
1|mapestat |    MYSQL_HOST: [SET]
1|mapestat |    MYSQL_USER: [SET]
1|mapestat |    MYSQL_DATABASE: [SET]
1|mapestat |    MYSQL_PORT: 3306
1|mapestat |    MYSQL_PASSWORD: [SET]
1|mapestat | 🔗 Using MySQL VPS configuration from environment variables
1|mapestat | 🔧 MySQL VPS: mysql://mapestate:***@localhost:3306/mapestate
1|mapestat | 🔗 Database configuration:
1|mapestat |    Host: localhost:3306
1|mapestat |    User: mapestate
1|mapestat |    Database: mapestate
1|mapestat | 🔄 Connecting to MySQL VPS database...
1|mapestat | ✅ MySQL VPS connection established successfully
1|mapestat | 🔍 Testing database connection...
1|mapestat | 💓 Database connection is healthy
1|mapestat | ✅ MySQL database initialized successfully
1|mapestat | 🔗 Using MySQL DatabaseStorage
1|mapestat | ℹ️ Default users already exist in database
1|mapestat | 🔧 Running startup fix for user language permissions...
1|mapestat | 🔧 Fixing existing users language permissions...
1|mapestat | Found 0 regular users to fix
1|mapestat | ✅ Finished fixing existing users language permissions
1|mapestat | 📁 Serving uploads from: /root/dailynewscrypto.net/server/uploads
1|mapestat | 4:55:35 PM [express] serving on port 3000

/root/.pm2/logs/mapestate-app-error.log last 30 lines:
0|mapestat | designed for a production environment, as it will leak
0|mapestat | memory, and will not scale past a single process.
0|mapestat | Warning: connect.session() MemoryStore is not
0|mapestat | designed for a production environment, as it will leak
0|mapestat | memory, and will not scale past a single process.
0|mapestat | Warning: connect.session() MemoryStore is not
0|mapestat | designed for a production environment, as it will leak
0|mapestat | memory, and will not scale past a single process.
0|mapestat | 🚫 Rate limit exceeded for auth: 130.193.219.72 - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.0 Safari/605.1.15
0|mapestat | 🚫 Rate limit exceeded for auth: 130.193.219.72 - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.0 Safari/605.1.15
0|mapestat | 🚫 Rate limit exceeded for auth: 130.193.219.72 - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.0 Safari/605.1.15
0|mapestat | 🚫 Rate limit exceeded for auth: 130.193.219.72 - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.0 Safari/605.1.15
0|mapestat | 🚫 Rate limit exceeded for auth: 130.193.219.72 - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.0 Safari/605.1.15
0|mapestat | 🚫 Rate limit exceeded for auth: 130.193.219.72 - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.0 Safari/605.1.15
0|mapestat | 🚫 Rate limit exceeded for auth: 130.193.219.72 - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.0 Safari/605.1.15
0|mapestat | Warning: connect.session() MemoryStore is not
0|mapestat | designed for a production environment, as it will leak
0|mapestat | memory, and will not scale past a single process.
0|mapestat | Warning: connect.session() MemoryStore is not
0|mapestat | designed for a production environment, as it will leak
0|mapestat | memory, and will not scale past a single process.
0|mapestat | Warning: connect.session() MemoryStore is not
0|mapestat | designed for a production environment, as it will leak
0|mapestat | memory, and will not scale past a single process.
0|mapestat | Warning: connect.session() MemoryStore is not
0|mapestat | designed for a production environment, as it will leak
0|mapestat | memory, and will not scale past a single process.
0|mapestat | Warning: connect.session() MemoryStore is not
0|mapestat | designed for a production environment, as it will leak
0|mapestat | memory, and will not scale past a single process.

/root/.pm2/logs/mapestate-app-out.log last 30 lines:
0|mapestat | 🔄 Connecting to MySQL VPS database...
0|mapestat | ✅ MySQL VPS connection established successfully
0|mapestat | 🔍 Testing database connection...
0|mapestat | 💓 Database connection is healthy
0|mapestat | ✅ MySQL database initialized successfully
0|mapestat | 🔗 Using MySQL DatabaseStorage
0|mapestat | ℹ️ Default users already exist in database
0|mapestat | 🔧 Running startup fix for user language permissions...
0|mapestat | 🔧 Fixing existing users language permissions...
0|mapestat | Found 0 regular users to fix
0|mapestat | ✅ Finished fixing existing users language permissions
0|mapestat | 📁 Serving uploads from: /root/dailynewscrypto.net/server/uploads
0|mapestat | 4:55:36 PM [express] serving on port 5000
0|mapestat | GET /api/auth/me 401 in 2ms : {"message":"Unauthorized"}
0|mapestat | GET /api/properties 200 in 8ms : []
0|mapestat | GET /api/properties/featured 200 in 4ms : []
0|mapestat | 🔌 New SSE connection established
0|mapestat | 📡 SSE padding sent, forcing stream start
0|mapestat | 📡 SSE initial connection message sent and flushed
0|mapestat | 📊 SSE clients connected: 1
0|mapestat | GET /api/auth/me 401 in 1ms : {"message":"Unauthorized"}
0|mapestat | GET /api/auth/me 401 in 1ms : {"message":"Unauthorized"}
0|mapestat | 💓 SSE heartbeat sent and flushed
0|mapestat | POST /api/auth/login 401 in 4ms : {"message":"Invalid username or password"}
0|mapestat | 🔌 SSE client disconnected (error): aborted
0|mapestat | 📊 SSE clients connected: 0
0|mapestat | 🔌 SSE client disconnected (close)
0|mapestat | 📊 SSE clients connected: 0
0|mapestat | POST /api/auth/login 401 in 4ms : {"message":"Invalid username or password"}
0|mapestat | POST /api/auth/login 401 in 3ms : {"message":"Invalid username or password"}

1|mapestate  | 🔍 Environment Variables Debug:
1|mapestate  |    MYSQL_URL: [NOT SET]
1|mapestate  |    MYSQL_HOST: [SET]
1|mapestate  |    MYSQL_USER: [SET]
1|mapestate  |    MYSQL_DATABASE: [SET]
1|mapestate  |    MYSQL_PORT: 3306
1|mapestate  |    MYSQL_PASSWORD: [SET]
1|mapestate  | 🔗 Using MySQL VPS configuration from environment variables
1|mapestate  | 🔧 MySQL VPS: mysql://mapestate:***@localhost:3306/mapestate
1|mapestate  | 🔗 Database configuration:
1|mapestate  |    Host: localhost:3306
1|mapestate  |    User: mapestate
1|mapestate  |    Database: mapestate
1|mapestate  | 🔄 Connecting to MySQL VPS database...
1|mapestate  | ✅ MySQL VPS connection established successfully
1|mapestate  | 🔍 Testing database connection...
1|mapestate  | 💓 Database connection is healthy
1|mapestate  | ✅ MySQL database initialized successfully
1|mapestate  | 🔗 Using MySQL DatabaseStorage
1|mapestate  | ℹ️ Default users already exist in database
1|mapestate  | 🔧 Running startup fix for user language permissions...
1|mapestate  | 🔧 Fixing existing users language permissions...
1|mapestate  | Found 0 regular users to fix
1|mapestate  | ✅ Finished fixing existing users language permissions
1|mapestate  | Warning: connect.session() MemoryStore is not
1|mapestate  | designed for a production environment, as it will leak
1|mapestate  | memory, and will not scale past a single process.
1|mapestate  | 📁 Serving uploads from: /root/dailynewscrypto.net/server/uploads
1|mapestate  | 5:01:43 PM [express] serving on port 3000
0|mapestate-app  | 🔍 Environment Variables Debug:
0|mapestate-app  |    MYSQL_URL: [NOT SET]
0|mapestate-app  |    MYSQL_HOST: [SET]
0|mapestate-app  |    MYSQL_USER: [SET]
0|mapestate-app  |    MYSQL_DATABASE: [SET]
0|mapestate-app  |    MYSQL_PORT: 3306
0|mapestate-app  |    MYSQL_PASSWORD: [SET]
0|mapestate-app  | 🔗 Using MySQL VPS configuration from environment variables
0|mapestate-app  | 🔧 MySQL VPS: mysql://mapestate:***@localhost:3306/mapestate
0|mapestate-app  | 🔗 Database configuration:
0|mapestate-app  |    Host: localhost:3306
0|mapestate-app  |    User: mapestate
0|mapestate-app  |    Database: mapestate
0|mapestate-app  | 🔄 Connecting to MySQL VPS database...
0|mapestate-app  | ✅ MySQL VPS connection established successfully
0|mapestate-app  | 🔍 Testing database connection...
0|mapestate-app  | 💓 Database connection is healthy
0|mapestate-app  | ✅ MySQL database initialized successfully
0|mapestate-app  | 🔗 Using MySQL DatabaseStorage
0|mapestate-app  | ℹ️ Default users already exist in database
0|mapestate-app  | 🔧 Running startup fix for user language permissions...
0|mapestate-app  | 🔧 Fixing existing users language permissions...
0|mapestate-app  | Found 0 regular users to fix
0|mapestate-app  | ✅ Finished fixing existing users language permissions
0|mapestate-app  | Warning: connect.session() MemoryStore is not
0|mapestate-app  | designed for a production environment, as it will leak
0|mapestate-app  | memory, and will not scale past a single process.
0|mapestate-app  | 📁 Serving uploads from: /root/dailynewscrypto.net/server/uploads
0|mapestate-app  | 5:01:45 PM [express] serving on port 5000
0|mapestate-app  | GET /api/auth/me 401 in 1ms : {"message":"Unauthorized"}
0|mapestate-app  | GET /api/auth/me 401 in 0ms : {"message":"Unauthorized"}
0|mapestate-app  | POST /api/auth/login 401 in 310ms : {"message":"Invalid username or password"}
0|mapestate-app  | POST /api/auth/login 401 in 297ms : {"message":"Invalid username or password"}
0|mapestate-app  | GET /api/auth/me 401 in 1ms : {"message":"Unauthorized"}
0|mapestate-app  | GET /api/properties/featured 304 in 11ms
0|mapestate-app  | 🔌 New SSE connection established
0|mapestate-app  | 📡 SSE padding sent, forcing stream start
0|mapestate-app  | 📡 SSE initial connection message sent and flushed
0|mapestate-app  | 📊 SSE clients connected: 1
0|mapestate-app  | GET /api/properties 304 in 4ms : []
0|mapestate-app  | GET /api/auth/me 401 in 0ms : {"message":"Unauthorized"}
0|mapestate-app  | 🔌 SSE client disconnected (error): aborted
0|mapestate-app  | 📊 SSE clients connected: 0
0|mapestate-app  | 🔌 SSE client disconnected (close)
0|mapestate-app  | 📊 SSE clients connected: 0
0|mapestate-app  | POST /api/auth/login 200 in 301ms : {"user":{"id":"admin-001","username":"admin…
0|mapestate-app  | GET /api/auth/me 200 in 7ms : {"id":"admin-001","username":"admin","email":"adm…
0|mapestate-app  | GET /api/auth/me 304 in 3ms : {"id":"admin-001","username":"admin","email":"adm…
0|mapestate-app  | GET /api/admin/users 200 in 4ms : [{"id":"admin-001","username":"admin","email"…
0|mapestate-app  | GET /api/admin/currency-rates 200 in 5ms : [{"id":"rate-004","fromCurrency":"EU…
0|mapestate-app  | GET /api/users/f407d771-5642-4ac8-b5b0-f0020bc9a9f3/languages 200 in 4ms : []
0|mapestate-app  | POST /api/upload/avatar 200 in 7ms : {"message":"File uploaded successfully","u…
0|mapestate-app  | PUT /api/admin/users/f407d771-5642-4ac8-b5b0-f0020bc9a9f3 200 in 334ms : {"id":…
0|mapestate-app  | GET /api/admin/users 200 in 4ms : [{"id":"admin-001","username":"admin","email"…
0|mapestate-app  | POST /api/upload/avatar 200 in 6ms : {"message":"File uploaded successfully","u…
0|mapestate-app  | 🔍 DEBUG: Raw request body: {
0|mapestate-app  |   "username": "farman",
0|mapestate-app  |   "email": "farman@gmail.com",
0|mapestate-app  |   "password": "farman@gmail.com",
0|mapestate-app  |   "role": "user",
0|mapestate-app  |   "firstName": "Farman",
0|mapestate-app  |   "lastName": "ak",
0|mapestate-app  |   "phone": "97793124242",
0|mapestate-app  |   "avatar": "https://dailynewscrypto.net/uploads/avatar/1759425701793-jb6u830os.png",
0|mapestate-app  |   "waveBalance": 10,
0|mapestate-app  |   "expiresAt": "2025-10-16T20:22",
0|mapestate-app  |   "isVerified": true
0|mapestate-app  | }
0|mapestate-app  | 🔍 DEBUG: User role: admin
0|mapestate-app  | 🔍 DEBUG: Processed body before validation (avatar truncated): {
0|mapestate-app  |   username: 'farman',
0|mapestate-app  |   email: 'farman@gmail.com',
0|mapestate-app  |   password: 'farman@gmail.com',
0|mapestate-app  |   role: 'user',
0|mapestate-app  |   firstName: 'Farman',
0|mapestate-app  |   lastName: 'ak',
0|mapestate-app  |   phone: '97793124242',
0|mapestate-app  |   avatar: '[Base64 image 70 chars]',
0|mapestate-app  |   waveBalance: 10,
0|mapestate-app  |   expiresAt: 2025-10-16T20:22:00.000Z,
0|mapestate-app  |   isVerified: true
0|mapestate-app  | }
0|mapestate-app  | POST /api/admin/users 201 in 341ms : {"id":"43b62fa7-0f70-49ab-8f69-dee1857aa47…
0|mapestate-app  | GET /api/admin/users 200 in 6ms : [{"id":"43b62fa7-0f70-49ab-8f69-dee1857aa47b"…
0|mapestate-app  | GET /api/users/43b62fa7-0f70-49ab-8f69-dee1857aa47b/properties 200 in 4ms : []
0|mapestate-app  | GET /api/customers/43b62fa7-0f70-49ab-8f69-dee1857aa47b/points 200 in 7ms : {"u…
0|mapestate-app  | GET /api/customers/43b62fa7-0f70-49ab-8f69-dee1857aa47b/activities 200 in 15ms …
0|mapestate-app  | GET /api/customers/43b62fa7-0f70-49ab-8f69-dee1857aa47b/analytics 200 in 4ms : …
