root@srv1027249:/var/www/dailynewscrypto.net# cd /var/www/dailynewscrypto.net

# Rename to .cjs (CommonJS format)
mv ecosystem.config.js ecosystem.config.cjs 2>/dev/null || true

# Create the config file
cat > ecosystem.config.cjs << 'EOF'
module.exports = {
  apps: [{
    name: 'mapestate',
    script: 'npm',
    args: 'start',
    env: {
      NODE_ENV: 'production',
      MYSQL_HOST: 'localhost',
      MYSQL_USER: 'mapestate',
      MYSQL_PASSWORD: 'MapEstate2024!',
      MYSQL_DATABASE: 'mapestate',
      MYSQL_PORT: '3306',
      SESSION_SECRET: 'your-production-secret-key-change-this'
    }
  }]
}
EOF

# Restart with ecosystem file
pm2 delete mapestate
pm2 start ecosystem.config.cjs
pm2 save
pm2 logs mapestate --lines 50
[PM2] Applying action deleteProcessId on app [mapestate](ids: [ 5 ])
[PM2] [mapestate](5) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 1  │ dailynewscrypto    │ fork     │ 19   │ online    │ 0%       │ 67.8mb   │
│ 2  │ dailynewscrypto    │ fork     │ 2    │ online    │ 0%       │ 67.6mb   │
│ 0  │ mapestate-api      │ fork     │ 4    │ online    │ 0%       │ 117.3mb  │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[PM2][WARN] Applications mapestate not running, starting...
[PM2] App [mapestate] launched (1 instances)
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 1  │ dailynewscrypto    │ fork     │ 19   │ online    │ 0%       │ 67.8mb   │
│ 2  │ dailynewscrypto    │ fork     │ 2    │ online    │ 0%       │ 67.6mb   │
│ 6  │ mapestate          │ fork     │ 0    │ online    │ 0%       │ 13.3mb   │
│ 0  │ mapestate-api      │ fork     │ 4    │ online    │ 0%       │ 117.3mb  │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[PM2] Saving current process list...
[PM2] Successfully saved in /root/.pm2/dump.pm2
[TAILING] Tailing last 50 lines for [mapestate] process (change the value with --lines option)
/root/.pm2/logs/mapestate-error.log last 50 lines:
6|mapestat | Warning: connect.session() MemoryStore is not
6|mapestat | designed for a production environment, as it will leak
6|mapestat | memory, and will not scale past a single process.
6|mapestat | Warning: connect.session() MemoryStore is not
6|mapestat | designed for a production environment, as it will leak
6|mapestat | memory, and will not scale past a single process.
6|mapestat | Warning: connect.session() MemoryStore is not
6|mapestat | designed for a production environment, as it will leak
6|mapestat | memory, and will not scale past a single process.
6|mapestat | Warning: connect.session() MemoryStore is not
6|mapestat | designed for a production environment, as it will leak
6|mapestat | memory, and will not scale past a single process.
6|mapestat | Warning: connect.session() MemoryStore is not
6|mapestat | designed for a production environment, as it will leak
6|mapestat | memory, and will not scale past a single process.
6|mapestat | Warning: connect.session() MemoryStore is not
6|mapestat | designed for a production environment, as it will leak
6|mapestat | memory, and will not scale past a single process.

/root/.pm2/logs/mapestate-out.log last 50 lines:
6|mapestat | 🔧 MySQL VPS: mysql://mapestate:***@localhost:3306/mapestate
6|mapestat | 🔗 Database configuration:
6|mapestat |    Host: localhost:3306
6|mapestat |    User: mapestate
6|mapestat |    Database: mapestate
6|mapestat | 🔄 Connecting to MySQL VPS database...
6|mapestat | ✅ MySQL VPS connection established successfully
6|mapestat | 🔍 Testing database connection...
6|mapestat | 💓 Database connection is healthy
6|mapestat | ✅ MySQL database initialized successfully
6|mapestat | 🔗 Using MySQL DatabaseStorage
6|mapestat | 🔧 Running startup fix for user language permissions...
6|mapestat | 🔧 Fixing existing users language permissions...
6|mapestat | Found 1 regular users to fix
6|mapestat | ✅ Finished fixing existing users language permissions
6|mapestat | 📁 Serving uploads from: /var/www/dailynewscrypto.net/dist/uploads
6|mapestat | 5:45:00 PM [express] serving on port 5000
6|mapestat | 
6|mapestat | > rest-express@1.0.0 start
6|mapestat | > node -r dotenv/config dist/index.js
6|mapestat | 
6|mapestat | 🔍 Environment Variables Debug:
6|mapestat |    MYSQL_URL: [NOT SET]
6|mapestat |    MYSQL_HOST: [SET]
6|mapestat |    MYSQL_USER: [SET]
6|mapestat |    MYSQL_DATABASE: [SET]
6|mapestat |    MYSQL_PORT: 3306
6|mapestat |    MYSQL_PASSWORD: [SET]
6|mapestat | 🔗 Using MySQL VPS configuration from environment variables
6|mapestat | 🔧 MySQL VPS: mysql://mapestate:***@localhost:3306/mapestate
6|mapestat | 🔗 Database configuration:
6|mapestat |    Host: localhost:3306
6|mapestat |    User: mapestate
6|mapestat |    Database: mapestate
6|mapestat | 🔄 Connecting to MySQL VPS database...
6|mapestat | ✅ MySQL VPS connection established successfully
6|mapestat | 🔍 Testing database connection...
6|mapestat | 💓 Database connection is healthy
6|mapestat | ✅ MySQL database initialized successfully
6|mapestat | 🔗 Using MySQL DatabaseStorage
6|mapestat | 🔧 Running startup fix for user language permissions...
6|mapestat | 🔧 Fixing existing users language permissions...
6|mapestat | Found 1 regular users to fix
6|mapestat | ✅ Finished fixing existing users language permissions
6|mapestat | 📁 Serving uploads from: /var/www/dailynewscrypto.net/dist/uploads
6|mapestat | 5:47:31 PM [express] serving on port 5000
6|mapestat | 
6|mapestat | > rest-express@1.0.0 start
6|mapestat | > node -r dotenv/config dist/index.js
6|mapestat | 

6|mapestate  | 🔍 Environment Variables Debug:
6|mapestate  |    MYSQL_URL: [NOT SET]
6|mapestate  |    MYSQL_HOST: [SET]
6|mapestate  |    MYSQL_USER: [SET]
6|mapestate  |    MYSQL_DATABASE: [SET]
6|mapestate  |    MYSQL_PORT: 3306
6|mapestate  |    MYSQL_PASSWORD: [SET]
6|mapestate  | 🔗 Using MySQL VPS configuration from environment variables
6|mapestate  | 🔧 MySQL VPS: mysql://mapestate:***@localhost:3306/mapestate
6|mapestate  | 🔗 Database configuration:
6|mapestate  |    Host: localhost:3306
6|mapestate  |    User: mapestate
6|mapestate  |    Database: mapestate
6|mapestate  | 🔄 Connecting to MySQL VPS database...
6|mapestate  | ✅ MySQL VPS connection established successfully
6|mapestate  | 🔍 Testing database connection...
6|mapestate  | 💓 Database connection is healthy
6|mapestate  | ✅ MySQL database initialized successfully
6|mapestate  | 🔗 Using MySQL DatabaseStorage
6|mapestate  | 🔧 Running startup fix for user language permissions...
6|mapestate  | 🔧 Fixing existing users language permissions...
6|mapestate  | Found 1 regular users to fix
6|mapestate  | ✅ Finished fixing existing users language permissions
6|mapestate  | Warning: connect.session() MemoryStore is not
6|mapestate  | designed for a production environment, as it will leak
6|mapestate  | memory, and will not scale past a single process.
6|mapestate  | 📁 Serving uploads from: /var/www/dailynewscrypto.net/dist/uploads
6|mapestate  | 5:48:19 PM [express] serving on port 5000
