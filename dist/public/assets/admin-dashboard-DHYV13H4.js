import{c as qe,R as k,N as ot,r as S,f as Ya,i as Xa,g as Ja,j as e,P as oa,h as Kt,v as Za,k as es,m as zt,J as je,B,M as be,O as wt,a as ca,I as ft,n as gt,K as Pe,d as ts}from"./index-gVtgMtKL.js";import{C as U,b as K,c as z,a as F,d as de}from"./card-C2dwsEa1.js";import{u as Ge,F as Ye,a as E,b as O,c as L,d as D,e as T,f as qt,z as P,t as Xe}from"./index-Cm5aqmom.js";import{I}from"./input-CLWbKIjf.js";import{u as as,S as Je,a as Ze,b as et,c as tt,d as te}from"./select-BY5_QmCp.js";import{s as ct,t as da,u as ss,E as rs,v as xe,w as le,x as lt,y as ma,z as ne,F as Pt,G as ze,H as xa,J as ha,K as ua,M as dt,N as mt,O as pa,Q as at,U as Se,V as ns,W as fa,X as Ve,Y as Be,Z as ga,i as is,A as xt,P as ya,b as va,c as ja,d as ge,e as ye,R as st,f as ls,g as os,h as cs,T as rt,B as ds,j as At,k as ms,a as xs,D as _e,_ as Wt,o as Te,p as Re,q as $e,r as Ie,S as ht,l as Ht,m as Qt,n as Gt,C as hs,I as us,$ as ps,a0 as fs}from"./PieChart-B_t8H8Y8.js";import{C as gs}from"./Combination-CC3rbWt6.js";import{B as se}from"./badge-BqUsHcl3.js";import{M as ys,A as Ue,a as Fe,b as Me}from"./avatar-DFQf8oBQ.js";import{L as Yt,E as ba}from"./label-BoyKRg9x.js";import{A as vs,U as nt}from"./users-B6HAKeZq.js";import{S as Na}from"./search-BBk3ArfH.js";import{H as Xt,M as js}from"./map-pin-BZWIKE3O.js";import{U as Jt}from"./user-Bs_15JvR.js";import{S as it}from"./shield-Dp7uVQGy.js";import{C as Ct}from"./calendar-BGpyh3-B.js";import{K as bs,H as Ns}from"./key-gsuhbt2y.js";import{D as ws}from"./dollar-sign-D6iGDoYY.js";import"./index-CnQ9kVxl.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=qe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=qe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=qe("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=qe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=qe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var ks=["type","layout","connectNulls","ref"],Ss=["key"];function Ee(a){"@babel/helpers - typeof";return Ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ee(a)}function ea(a,t){if(a==null)return{};var n=Ps(a,t),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(a,r)&&(n[r]=a[r])}return n}function Ps(a,t){if(a==null)return{};var n={};for(var r in a)if(Object.prototype.hasOwnProperty.call(a,r)){if(t.indexOf(r)>=0)continue;n[r]=a[r]}return n}function Ke(){return Ke=Object.assign?Object.assign.bind():function(a){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(a[r]=n[r])}return a},Ke.apply(this,arguments)}function ta(a,t){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),n.push.apply(n,r)}return n}function ae(a){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ta(Object(n),!0).forEach(function(r){re(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):ta(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}function ke(a){return Ds(a)||Ls(a)||Os(a)||Es()}function Es(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Os(a,t){if(a){if(typeof a=="string")return Et(a,t);var n=Object.prototype.toString.call(a).slice(8,-1);if(n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set")return Array.from(a);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Et(a,t)}}function Ls(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Ds(a){if(Array.isArray(a))return Et(a)}function Et(a,t){(t==null||t>a.length)&&(t=a.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=a[n];return r}function _s(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function aa(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,Aa(r.key),r)}}function Ts(a,t,n){return t&&aa(a.prototype,t),n&&aa(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}function Rs(a,t,n){return t=ut(t),$s(a,wa()?Reflect.construct(t,n||[],ut(a).constructor):t.apply(a,n))}function $s(a,t){if(t&&(Ee(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Is(a)}function Is(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function wa(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wa=function(){return!!a})()}function ut(a){return ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ut(a)}function Us(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Ot(a,t)}function Ot(a,t){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Ot(a,t)}function re(a,t,n){return t=Aa(t),t in a?Object.defineProperty(a,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[t]=n,a}function Aa(a){var t=Fs(a,"string");return Ee(t)=="symbol"?t:t+""}function Fs(a,t){if(Ee(a)!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var r=n.call(a,t||"default");if(Ee(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(a)}var We=function(a){function t(){var n;_s(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return n=Rs(this,t,[].concat(i)),re(n,"state",{isAnimationFinished:!0,totalLength:0}),re(n,"generateSimpleStrokeDasharray",function(l,c){return"".concat(c,"px ").concat(l-c,"px")}),re(n,"getStrokeDasharray",function(l,c,m){var u=m.reduce(function(p,b){return p+b});if(!u)return n.generateSimpleStrokeDasharray(c,l);for(var d=Math.floor(l/u),f=l%u,g=c-l,v=[],y=0,w=0;y<m.length;w+=m[y],++y)if(w+m[y]>f){v=[].concat(ke(m.slice(0,y)),[f-w]);break}var A=v.length%2===0?[0,g]:[g];return[].concat(ke(t.repeat(m,d)),ke(v),A).map(function(p){return"".concat(p,"px")}).join(", ")}),re(n,"id",pa("recharts-line-")),re(n,"pathRef",function(l){n.mainCurve=l}),re(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),re(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return Us(t,a),Ts(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,l=o.points,c=o.xAxis,m=o.yAxis,u=o.layout,d=o.children,f=ss(d,rs);if(!f)return null;var g=function(w,A){return{x:w.x,y:w.y,value:w.value,errorVal:dt(w.payload,A)}},v={clipPath:r?"url(#clipPath-".concat(i,")"):null};return k.createElement(xe,v,f.map(function(y){return k.cloneElement(y,{key:"bar-".concat(y.props.dataKey),data:l,xAxis:c,yAxis:m,layout:u,dataPointFormatter:g})}))}},{key:"renderDots",value:function(r,i,o){var l=this.props.isAnimationActive;if(l&&!this.state.isAnimationFinished)return null;var c=this.props,m=c.dot,u=c.points,d=c.dataKey,f=le(this.props,!1),g=le(m,!0),v=u.map(function(w,A){var p=ae(ae(ae({key:"dot-".concat(A),r:3},f),g),{},{index:A,cx:w.x,cy:w.y,value:w.value,dataKey:d,payload:w.payload,points:u});return t.renderDotItem(m,p)}),y={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return k.createElement(xe,Ke({className:"recharts-line-dots",key:"dots"},y),v)}},{key:"renderCurveStatically",value:function(r,i,o,l){var c=this.props,m=c.type,u=c.layout,d=c.connectNulls;c.ref;var f=ea(c,ks),g=ae(ae(ae({},le(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(o,")"):null,points:r},l),{},{type:m,layout:u,connectNulls:d});return k.createElement(lt,Ke({},g,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,i){var o=this,l=this.props,c=l.points,m=l.strokeDasharray,u=l.isAnimationActive,d=l.animationBegin,f=l.animationDuration,g=l.animationEasing,v=l.animationId,y=l.animateNewValues,w=l.width,A=l.height,p=this.state,b=p.prevPoints,R=p.totalLength;return k.createElement(ma,{begin:d,duration:f,isActive:u,easing:g,from:{t:0},to:{t:1},key:"line-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(N){var j=N.t;if(b){var _=b.length/c.length,$=c.map(function(M,Z){var ie=Math.floor(Z*_);if(b[ie]){var ee=b[ie],q=ne(ee.x,M.x),He=ne(ee.y,M.y);return ae(ae({},M),{},{x:q(j),y:He(j)})}if(y){var Q=ne(w*2,M.x),W=ne(A/2,M.y);return ae(ae({},M),{},{x:Q(j),y:W(j)})}return ae(ae({},M),{},{x:M.x,y:M.y})});return o.renderCurveStatically($,r,i)}var x=ne(0,R),J=x(j),X;if(m){var Y="".concat(m).split(/[,\s]+/gim).map(function(M){return parseFloat(M)});X=o.getStrokeDasharray(J,R,Y)}else X=o.generateSimpleStrokeDasharray(R,J);return o.renderCurveStatically(c,r,i,{strokeDasharray:X})})}},{key:"renderCurve",value:function(r,i){var o=this.props,l=o.points,c=o.isAnimationActive,m=this.state,u=m.prevPoints,d=m.totalLength;return c&&l&&l.length&&(!u&&d>0||!Pt(u,l))?this.renderCurveWithAnimation(r,i):this.renderCurveStatically(l,r,i)}},{key:"render",value:function(){var r,i=this.props,o=i.hide,l=i.dot,c=i.points,m=i.className,u=i.xAxis,d=i.yAxis,f=i.top,g=i.left,v=i.width,y=i.height,w=i.isAnimationActive,A=i.id;if(o||!c||!c.length)return null;var p=this.state.isAnimationFinished,b=c.length===1,R=ot("recharts-line",m),N=u&&u.allowDataOverflow,j=d&&d.allowDataOverflow,_=N||j,$=ze(A)?this.id:A,x=(r=le(l,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},J=x.r,X=J===void 0?3:J,Y=x.strokeWidth,M=Y===void 0?2:Y,Z=xa(l)?l:{},ie=Z.clipDot,ee=ie===void 0?!0:ie,q=X*2+M;return k.createElement(xe,{className:R},N||j?k.createElement("defs",null,k.createElement("clipPath",{id:"clipPath-".concat($)},k.createElement("rect",{x:N?g:g-v/2,y:j?f:f-y/2,width:N?v:v*2,height:j?y:y*2})),!ee&&k.createElement("clipPath",{id:"clipPath-dots-".concat($)},k.createElement("rect",{x:g-q/2,y:f-q/2,width:v+q,height:y+q}))):null,!b&&this.renderCurve(_,$),this.renderErrorBar(_,$),(b||l)&&this.renderDots(_,ee,$),(!w||p)&&ha.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:i.curPoints}:r.points!==i.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,i){for(var o=r.length%2!==0?[].concat(ke(r),[0]):r,l=[],c=0;c<i;++c)l=[].concat(ke(l),ke(o));return l}},{key:"renderDotItem",value:function(r,i){var o;if(k.isValidElement(r))o=k.cloneElement(r,i);else if(ct(r))o=r(i);else{var l=i.key,c=ea(i,Ss),m=ot("recharts-line-dot",typeof r!="boolean"?r.className:"");o=k.createElement(da,Ke({key:l},c,{className:m}))}return o}}])}(S.PureComponent);re(We,"displayName","Line");re(We,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!ua.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});re(We,"getComposedData",function(a){var t=a.props,n=a.xAxis,r=a.yAxis,i=a.xAxisTicks,o=a.yAxisTicks,l=a.dataKey,c=a.bandSize,m=a.displayedData,u=a.offset,d=t.layout,f=m.map(function(g,v){var y=dt(g,l);return d==="horizontal"?{x:mt({axis:n,ticks:i,bandSize:c,entry:g,index:v}),y:ze(y)?null:r.scale(y),value:y,payload:g}:{x:ze(y)?null:n.scale(y),y:mt({axis:r,ticks:o,bandSize:c,entry:g,index:v}),value:y,payload:g}});return ae({points:f,layout:d},u)});var Ms=["layout","type","stroke","connectNulls","isRange","ref"],Vs=["key"],Ca;function Oe(a){"@babel/helpers - typeof";return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(a)}function ka(a,t){if(a==null)return{};var n=Bs(a,t),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(a,r)&&(n[r]=a[r])}return n}function Bs(a,t){if(a==null)return{};var n={};for(var r in a)if(Object.prototype.hasOwnProperty.call(a,r)){if(t.indexOf(r)>=0)continue;n[r]=a[r]}return n}function ve(){return ve=Object.assign?Object.assign.bind():function(a){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(a[r]=n[r])}return a},ve.apply(this,arguments)}function sa(a,t){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),n.push.apply(n,r)}return n}function me(a){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sa(Object(n),!0).forEach(function(r){oe(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):sa(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}function Ks(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function ra(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,Pa(r.key),r)}}function zs(a,t,n){return t&&ra(a.prototype,t),n&&ra(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}function qs(a,t,n){return t=pt(t),Ws(a,Sa()?Reflect.construct(t,n||[],pt(a).constructor):t.apply(a,n))}function Ws(a,t){if(t&&(Oe(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hs(a)}function Hs(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Sa(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sa=function(){return!!a})()}function pt(a){return pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},pt(a)}function Qs(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&Lt(a,t)}function Lt(a,t){return Lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Lt(a,t)}function oe(a,t,n){return t=Pa(t),t in a?Object.defineProperty(a,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[t]=n,a}function Pa(a){var t=Gs(a,"string");return Oe(t)=="symbol"?t:t+""}function Gs(a,t){if(Oe(a)!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var r=n.call(a,t||"default");if(Oe(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(a)}var ue=function(a){function t(){var n;Ks(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return n=qs(this,t,[].concat(i)),oe(n,"state",{isAnimationFinished:!0}),oe(n,"id",pa("recharts-area-")),oe(n,"handleAnimationEnd",function(){var l=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),ct(l)&&l()}),oe(n,"handleAnimationStart",function(){var l=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),ct(l)&&l()}),n}return Qs(t,a),zs(t,[{key:"renderDots",value:function(r,i,o){var l=this.props.isAnimationActive,c=this.state.isAnimationFinished;if(l&&!c)return null;var m=this.props,u=m.dot,d=m.points,f=m.dataKey,g=le(this.props,!1),v=le(u,!0),y=d.map(function(A,p){var b=me(me(me({key:"dot-".concat(p),r:3},g),v),{},{index:p,cx:A.x,cy:A.y,dataKey:f,value:A.value,payload:A.payload,points:d});return t.renderDotItem(u,b)}),w={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return k.createElement(xe,ve({className:"recharts-area-dots"},w),y)}},{key:"renderHorizontalRect",value:function(r){var i=this.props,o=i.baseLine,l=i.points,c=i.strokeWidth,m=l[0].x,u=l[l.length-1].x,d=r*Math.abs(m-u),f=at(l.map(function(g){return g.y||0}));return Se(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(at(o.map(function(g){return g.y||0})),f)),Se(f)?k.createElement("rect",{x:m<u?m:m-d,y:0,width:d,height:Math.floor(f+(c?parseInt("".concat(c),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var i=this.props,o=i.baseLine,l=i.points,c=i.strokeWidth,m=l[0].y,u=l[l.length-1].y,d=r*Math.abs(m-u),f=at(l.map(function(g){return g.x||0}));return Se(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(at(o.map(function(g){return g.x||0})),f)),Se(f)?k.createElement("rect",{x:0,y:m<u?m:m-d,width:f+(c?parseInt("".concat(c),10):1),height:Math.floor(d)}):null}},{key:"renderClipRect",value:function(r){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,i,o,l){var c=this.props,m=c.layout,u=c.type,d=c.stroke,f=c.connectNulls,g=c.isRange;c.ref;var v=ka(c,Ms);return k.createElement(xe,{clipPath:o?"url(#clipPath-".concat(l,")"):null},k.createElement(lt,ve({},le(v,!0),{points:r,connectNulls:f,type:u,baseLine:i,layout:m,stroke:"none",className:"recharts-area-area"})),d!=="none"&&k.createElement(lt,ve({},le(this.props,!1),{className:"recharts-area-curve",layout:m,type:u,connectNulls:f,fill:"none",points:r})),d!=="none"&&g&&k.createElement(lt,ve({},le(this.props,!1),{className:"recharts-area-curve",layout:m,type:u,connectNulls:f,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(r,i){var o=this,l=this.props,c=l.points,m=l.baseLine,u=l.isAnimationActive,d=l.animationBegin,f=l.animationDuration,g=l.animationEasing,v=l.animationId,y=this.state,w=y.prevPoints,A=y.prevBaseLine;return k.createElement(ma,{begin:d,duration:f,isActive:u,easing:g,from:{t:0},to:{t:1},key:"area-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var b=p.t;if(w){var R=w.length/c.length,N=c.map(function(x,J){var X=Math.floor(J*R);if(w[X]){var Y=w[X],M=ne(Y.x,x.x),Z=ne(Y.y,x.y);return me(me({},x),{},{x:M(b),y:Z(b)})}return x}),j;if(Se(m)&&typeof m=="number"){var _=ne(A,m);j=_(b)}else if(ze(m)||ns(m)){var $=ne(A,0);j=$(b)}else j=m.map(function(x,J){var X=Math.floor(J*R);if(A[X]){var Y=A[X],M=ne(Y.x,x.x),Z=ne(Y.y,x.y);return me(me({},x),{},{x:M(b),y:Z(b)})}return x});return o.renderAreaStatically(N,j,r,i)}return k.createElement(xe,null,k.createElement("defs",null,k.createElement("clipPath",{id:"animationClipPath-".concat(i)},o.renderClipRect(b))),k.createElement(xe,{clipPath:"url(#animationClipPath-".concat(i,")")},o.renderAreaStatically(c,m,r,i)))})}},{key:"renderArea",value:function(r,i){var o=this.props,l=o.points,c=o.baseLine,m=o.isAnimationActive,u=this.state,d=u.prevPoints,f=u.prevBaseLine,g=u.totalLength;return m&&l&&l.length&&(!d&&g>0||!Pt(d,l)||!Pt(f,c))?this.renderAreaWithAnimation(r,i):this.renderAreaStatically(l,c,r,i)}},{key:"render",value:function(){var r,i=this.props,o=i.hide,l=i.dot,c=i.points,m=i.className,u=i.top,d=i.left,f=i.xAxis,g=i.yAxis,v=i.width,y=i.height,w=i.isAnimationActive,A=i.id;if(o||!c||!c.length)return null;var p=this.state.isAnimationFinished,b=c.length===1,R=ot("recharts-area",m),N=f&&f.allowDataOverflow,j=g&&g.allowDataOverflow,_=N||j,$=ze(A)?this.id:A,x=(r=le(l,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},J=x.r,X=J===void 0?3:J,Y=x.strokeWidth,M=Y===void 0?2:Y,Z=xa(l)?l:{},ie=Z.clipDot,ee=ie===void 0?!0:ie,q=X*2+M;return k.createElement(xe,{className:R},N||j?k.createElement("defs",null,k.createElement("clipPath",{id:"clipPath-".concat($)},k.createElement("rect",{x:N?d:d-v/2,y:j?u:u-y/2,width:N?v:v*2,height:j?y:y*2})),!ee&&k.createElement("clipPath",{id:"clipPath-dots-".concat($)},k.createElement("rect",{x:d-q/2,y:u-q/2,width:v+q,height:y+q}))):null,b?null:this.renderArea(_,$),(l||b)&&this.renderDots(_,ee,$),(!w||p)&&ha.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:r.points!==i.curPoints||r.baseLine!==i.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])}(S.PureComponent);Ca=ue;oe(ue,"displayName","Area");oe(ue,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!ua.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});oe(ue,"getBaseValue",function(a,t,n,r){var i=a.layout,o=a.baseValue,l=t.props.baseValue,c=l??o;if(Se(c)&&typeof c=="number")return c;var m=i==="horizontal"?r:n,u=m.scale.domain();if(m.type==="number"){var d=Math.max(u[0],u[1]),f=Math.min(u[0],u[1]);return c==="dataMin"?f:c==="dataMax"||d<0?d:Math.max(Math.min(u[0],u[1]),0)}return c==="dataMin"?u[0]:c==="dataMax"?u[1]:u[0]});oe(ue,"getComposedData",function(a){var t=a.props,n=a.item,r=a.xAxis,i=a.yAxis,o=a.xAxisTicks,l=a.yAxisTicks,c=a.bandSize,m=a.dataKey,u=a.stackedData,d=a.dataStartIndex,f=a.displayedData,g=a.offset,v=t.layout,y=u&&u.length,w=Ca.getBaseValue(t,n,r,i),A=v==="horizontal",p=!1,b=f.map(function(N,j){var _;y?_=u[d+j]:(_=dt(N,m),Array.isArray(_)?p=!0:_=[w,_]);var $=_[1]==null||y&&dt(N,m)==null;return A?{x:mt({axis:r,ticks:o,bandSize:c,entry:N,index:j}),y:$?null:i.scale(_[1]),value:_,payload:N}:{x:$?null:r.scale(_[1]),y:mt({axis:i,ticks:l,bandSize:c,entry:N,index:j}),value:_,payload:N}}),R;return y||p?R=b.map(function(N){var j=Array.isArray(N.value)?N.value[0]:null;return A?{x:N.x,y:j!=null&&N.y!=null?i.scale(j):null}:{x:j!=null?r.scale(j):null,y:N.y}}):R=A?i.scale(w):r.scale(w),me({points:b,baseLine:R,layout:v,isRange:p},g)});oe(ue,"renderDotItem",function(a,t){var n;if(k.isValidElement(a))n=k.cloneElement(a,t);else if(ct(a))n=a(t);else{var r=ot("recharts-area-dot",typeof a!="boolean"?a.className:""),i=t.key,o=ka(t,Vs);n=k.createElement(da,ve({},o,{key:i,className:r}))}return n});var Ys=fa({chartName:"LineChart",GraphicalChild:We,axisComponents:[{axisType:"xAxis",AxisComp:Ve},{axisType:"yAxis",AxisComp:Be}],formatAxisMap:ga}),Xs=fa({chartName:"AreaChart",GraphicalChild:ue,axisComponents:[{axisType:"xAxis",AxisComp:Ve},{axisType:"yAxis",AxisComp:Be}],formatAxisMap:ga}),Dt="Checkbox",[Js,Tr]=Ya(Dt),[Zs,er]=Js(Dt),Ea=S.forwardRef((a,t)=>{const{__scopeCheckbox:n,name:r,checked:i,defaultChecked:o,required:l,disabled:c,value:m="on",onCheckedChange:u,form:d,...f}=a,[g,v]=S.useState(null),y=Xa(t,N=>v(N)),w=S.useRef(!1),A=g?d||!!g.closest("form"):!0,[p=!1,b]=Ja({prop:i,defaultProp:o,onChange:u}),R=S.useRef(p);return S.useEffect(()=>{const N=g==null?void 0:g.form;if(N){const j=()=>b(R.current);return N.addEventListener("reset",j),()=>N.removeEventListener("reset",j)}},[g,b]),e.jsxs(Zs,{scope:n,state:p,disabled:c,children:[e.jsx(oa.button,{type:"button",role:"checkbox","aria-checked":he(p)?"mixed":p,"aria-required":l,"data-state":Da(p),"data-disabled":c?"":void 0,disabled:c,value:m,...f,ref:y,onKeyDown:Kt(a.onKeyDown,N=>{N.key==="Enter"&&N.preventDefault()}),onClick:Kt(a.onClick,N=>{b(j=>he(j)?!0:!j),A&&(w.current=N.isPropagationStopped(),w.current||N.stopPropagation())})}),A&&e.jsx(tr,{control:g,bubbles:!w.current,name:r,value:m,checked:p,required:l,disabled:c,form:d,style:{transform:"translateX(-100%)"},defaultChecked:he(o)?!1:o})]})});Ea.displayName=Dt;var Oa="CheckboxIndicator",La=S.forwardRef((a,t)=>{const{__scopeCheckbox:n,forceMount:r,...i}=a,o=er(Oa,n);return e.jsx(Za,{present:r||he(o.state)||o.state===!0,children:e.jsx(oa.span,{"data-state":Da(o.state),"data-disabled":o.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...a.style}})})});La.displayName=Oa;var tr=a=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:i,...o}=a,l=S.useRef(null),c=as(n),m=es(t);S.useEffect(()=>{const d=l.current,f=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(f,"checked").set;if(c!==n&&v){const y=new Event("click",{bubbles:r});d.indeterminate=he(n),v.call(d,he(n)?!1:n),d.dispatchEvent(y)}},[c,n,r]);const u=S.useRef(he(n)?!1:n);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??u.current,...o,tabIndex:-1,ref:l,style:{...a.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function he(a){return a==="indeterminate"}function Da(a){return he(a)?"indeterminate":a?"checked":"unchecked"}var _a=Ea,ar=La;const fe=S.forwardRef(({className:a,...t},n)=>e.jsx(_a,{ref:n,className:zt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...t,children:e.jsx(ar,{className:zt("flex items-center justify-center text-current"),children:e.jsx(gs,{className:"h-4 w-4"})})}));fe.displayName=_a.displayName;const sr={property_view:"#3b82f6",search:"#10b981",favorite_add:"#f59e0b",favorite_remove:"#ef4444",inquiry_sent:"#8b5cf6",login:"#06b6d4",profile_update:"#84cc16"},rr={property_view:ba,search:Na,favorite_add:Xt,favorite_remove:Xt,inquiry_sent:ys,login:Jt,profile_update:Jt},na={Bronze:"#cd7f32",Silver:"#c0c0c0",Gold:"#ffd700",Platinum:"#e5e4e2"};function nr({customerId:a,customerName:t}){var A;const[n,r]=S.useState(0),[i,o]=S.useState("property_view"),{data:l,isLoading:c}=je({queryKey:[`/api/customers/${a}/points`],enabled:!!a}),{data:m=[],isLoading:u}=je({queryKey:[`/api/customers/${a}/activities`],enabled:!!a}),{data:d,isLoading:f}=je({queryKey:[`/api/customers/${a}/analytics`],enabled:!!a}),g=async()=>{try{await be(`/api/customers/${a}/activity`,{method:"POST",body:JSON.stringify({activityType:i,points:n,metadata:{source:"admin_dashboard",timestamp:new Date().toISOString()}})}),wt.invalidateQueries({queryKey:[`/api/customers/${a}/points`]}),wt.invalidateQueries({queryKey:[`/api/customers/${a}/activities`]}),wt.invalidateQueries({queryKey:[`/api/customers/${a}/analytics`]}),r(0)}catch(p){console.error("Failed to add customer activity:",p)}},v=p=>p.replace(/_/g," ").replace(/\b\w/g,b=>b.toUpperCase()),y=p=>{const b=rr[p]||xt;return e.jsx(b,{className:"h-4 w-4"})},w=p=>new Date(p).toLocaleDateString();return c||u||f?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-orange-600 border-t-transparent rounded-full"}),e.jsx("span",{className:"ml-3",children:"Loading analytics..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(U,{children:[e.jsx(K,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Total Points"]})}),e.jsx(F,{children:e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(l==null?void 0:l.totalPoints)||0})})]}),e.jsxs(U,{children:[e.jsx(K,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(Cs,{className:"h-4 w-4 mr-2"}),"Current Level"]})}),e.jsx(F,{children:e.jsx(se,{style:{backgroundColor:na[l==null?void 0:l.currentLevel]||na.Bronze,color:"white"},children:(l==null?void 0:l.currentLevel)||"Bronze"})})]}),e.jsxs(U,{children:[e.jsx(K,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"This Month"]})}),e.jsx(F,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(l==null?void 0:l.pointsThisMonth)||0})})]}),e.jsxs(U,{children:[e.jsx(K,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(xt,{className:"h-4 w-4 mr-2"}),"Total Activities"]})}),e.jsx(F,{children:e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(d==null?void 0:d.totalActivities)||0})})]})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsxs(z,{className:"flex items-center",children:[e.jsx(ya,{className:"h-5 w-5 mr-2"}),"Add Customer Activity"]}),e.jsxs(de,{children:["Award points to ",t," for their engagement"]})]}),e.jsx(F,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(Yt,{htmlFor:"activity-type",children:"Activity Type"}),e.jsxs("select",{id:"activity-type",value:i,onChange:p=>o(p.target.value),className:"w-full mt-1 p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"property_view",children:"Property View"}),e.jsx("option",{value:"search",children:"Search"}),e.jsx("option",{value:"favorite_add",children:"Favorite Added"}),e.jsx("option",{value:"inquiry_sent",children:"Inquiry Sent"}),e.jsx("option",{value:"login",children:"Login"}),e.jsx("option",{value:"profile_update",children:"Profile Update"})]})]}),e.jsxs("div",{children:[e.jsx(Yt,{htmlFor:"points",children:"Points to Award"}),e.jsx(I,{id:"points",type:"number",value:n,onChange:p=>r(parseInt(p.target.value)||0),min:0,max:100,"data-testid":"input-points-to-add"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(B,{onClick:g,className:"w-full","data-testid":"button-add-activity",children:"Add Activity"})})]})})]}),e.jsxs(va,{defaultValue:"overview",className:"space-y-4",children:[e.jsxs(ja,{className:"grid w-full grid-cols-4",children:[e.jsx(ge,{value:"overview",children:"Overview"}),e.jsx(ge,{value:"activities",children:"Activities"}),e.jsx(ge,{value:"trends",children:"Trends"}),e.jsx(ge,{value:"history",children:"History"})]}),e.jsx(ye,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(z,{children:"Activities by Type"}),e.jsx(de,{children:"Breakdown of customer engagement activities"})]}),e.jsx(F,{children:e.jsx(st,{width:"100%",height:300,children:e.jsxs(ls,{children:[e.jsx(os,{data:(d==null?void 0:d.activitiesByType)||[],cx:"50%",cy:"50%",labelLine:!1,label:({name:p,value:b})=>`${v(p)}: ${b}`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:(A=d==null?void 0:d.activitiesByType)==null?void 0:A.map((p,b)=>e.jsx(cs,{fill:sr[p.activityType]||"#8884d8"},`cell-${b}`))}),e.jsx(rt,{})]})})})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(z,{children:"Points by Activity Type"}),e.jsx(de,{children:"Points earned from different activities"})]}),e.jsx(F,{children:e.jsx(st,{width:"100%",height:300,children:e.jsxs(ds,{data:(d==null?void 0:d.activitiesByType)||[],children:[e.jsx(At,{strokeDasharray:"3 3"}),e.jsx(Ve,{dataKey:"activityType",tick:{fontSize:12},tickFormatter:v}),e.jsx(Be,{}),e.jsx(rt,{labelFormatter:p=>v(p),formatter:p=>[`${p} points`,"Points"]}),e.jsx(ms,{dataKey:"points",fill:"#f59e0b"})]})})})]})]})}),e.jsx(ye,{value:"activities",className:"space-y-4",children:e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(z,{children:"Recent Activities"}),e.jsx(de,{children:"Latest customer engagement activities"})]}),e.jsx(F,{children:e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:m.map(p=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-gray-100",children:y(p.activityType)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:v(p.activityType)}),e.jsx("div",{className:"text-sm text-gray-500",children:w(p.createdAt)})]})]}),e.jsxs(se,{variant:"outline",children:["+",p.points," points"]})]},p.id))})})]})}),e.jsx(ye,{value:"trends",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(z,{children:"Points History (Last 30 Days)"}),e.jsx(de,{children:"Daily points earned over time"})]}),e.jsx(F,{children:e.jsx(st,{width:"100%",height:300,children:e.jsxs(Ys,{data:(d==null?void 0:d.pointsHistory)||[],children:[e.jsx(At,{strokeDasharray:"3 3"}),e.jsx(Ve,{dataKey:"date"}),e.jsx(Be,{}),e.jsx(rt,{}),e.jsx(We,{type:"monotone",dataKey:"points",stroke:"#f59e0b",strokeWidth:2,dot:{fill:"#f59e0b"}})]})})})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(z,{children:"Monthly Activity Trend"}),e.jsx(de,{children:"Activity levels over the last 12 months"})]}),e.jsx(F,{children:e.jsx(st,{width:"100%",height:300,children:e.jsxs(Xs,{data:(d==null?void 0:d.monthlyActivity)||[],children:[e.jsx(At,{strokeDasharray:"3 3"}),e.jsx(Ve,{dataKey:"month"}),e.jsx(Be,{}),e.jsx(rt,{}),e.jsx(ue,{type:"monotone",dataKey:"activities",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6})]})})})]})]})}),e.jsx(ye,{value:"history",className:"space-y-4",children:e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(z,{children:"Complete Activity History"}),e.jsx(de,{children:"Detailed log of all customer activities"})]}),e.jsx(F,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Date"}),e.jsx("th",{className:"text-left p-2",children:"Activity"}),e.jsx("th",{className:"text-left p-2",children:"Points"}),e.jsx("th",{className:"text-left p-2",children:"Details"})]})}),e.jsx("tbody",{children:m.map(p=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-2",children:w(p.createdAt)}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[y(p.activityType),e.jsx("span",{children:v(p.activityType)})]})}),e.jsx("td",{className:"p-2",children:e.jsxs(se,{variant:"outline",children:["+",p.points]})}),e.jsx("td",{className:"p-2 text-gray-500",children:p.propertyId?`Property: ${p.propertyId.substring(0,8)}...`:"General activity"})]},p.id))})]})})})]})})]})]})}function ir(){const{user:a}=ca();return je({queryKey:["/api/admin/currency-rates"],enabled:(a==null?void 0:a.role)==="admin"||(a==null?void 0:a.role)==="super_admin",staleTime:5*60*1e3})}function lr(){const a=ft(),{toast:t}=gt();return Pe({mutationFn:async n=>await(await be("POST","/api/admin/currency-rates",{fromCurrency:"USD",toCurrency:n.toCurrency,rate:n.rate,isActive:n.isActive??!0})).json(),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/admin/currency-rates"]}),a.invalidateQueries({queryKey:["/api/admin/currency-rates/active"]}),t({title:"Success",description:"Currency exchange rate created successfully"})},onError:n=>{t({title:"Error",description:n.message||"Failed to create currency rate",variant:"destructive"})}})}function or(){const a=ft(),{toast:t}=gt();return Pe({mutationFn:async({id:n,data:r})=>await(await be("PUT",`/api/admin/currency-rates/${n}`,{rate:r.rate,isActive:r.isActive})).json(),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/admin/currency-rates"]}),a.invalidateQueries({queryKey:["/api/admin/currency-rates/active"]}),t({title:"Success",description:"Currency exchange rate updated successfully"})},onError:n=>{t({title:"Error",description:n.message||"Failed to update currency rate",variant:"destructive"})}})}function cr(){const a=ft(),{toast:t}=gt();return Pe({mutationFn:async n=>await(await be("DELETE",`/api/admin/currency-rates/${n}`)).json(),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/admin/currency-rates"]}),a.invalidateQueries({queryKey:["/api/admin/currency-rates/active"]}),t({title:"Success",description:"Currency exchange rate deactivated successfully"})},onError:n=>{t({title:"Error",description:n.message||"Failed to deactivate currency rate",variant:"destructive"})}})}const dr=P.object({username:P.string().min(3,"Username must be at least 3 characters"),email:P.string().email("Please enter a valid email"),password:P.string().min(6,"Password must be at least 6 characters"),role:P.enum(["user","agent","admin"]),firstName:P.string().optional(),lastName:P.string().optional(),phone:P.string().optional(),avatar:P.string().optional(),waveBalance:P.number().min(0,"Wave balance must be 0 or greater").default(0),expiresAt:P.string().optional(),isVerified:P.boolean().default(!1),allowedLanguages:P.array(P.enum(ht)).default(["en"]).optional()}),mr=P.object({username:P.string().min(3,"Username must be at least 3 characters"),email:P.string().email("Please enter a valid email"),password:P.string().min(6,"Password must be at least 6 characters").optional(),role:P.enum(["user","agent","admin"]),firstName:P.string().optional(),lastName:P.string().optional(),phone:P.string().optional(),avatar:P.string().optional(),waveBalance:P.number().min(0,"Wave balance must be 0 or greater").default(0),expiresAt:P.string().optional(),isVerified:P.boolean().default(!1),allowedLanguages:P.array(P.enum(ht)).optional()}),xr=ps.extend({toCurrency:P.enum(["IQD","EUR","AED"],{required_error:"Please select a target currency"}),rate:P.coerce.number().positive("Exchange rate must be greater than 0")}),hr=fs.extend({rate:P.coerce.number().positive("Exchange rate must be greater than 0")}),ia=a=>{if(!a)return null;const t=new Date,r=(a instanceof Date?a:new Date(a)).getTime()-t.getTime();return Math.ceil(r/(1e3*60*60*24))},la=a=>a===null?{status:"No Expiration",color:"text-green-600",bgColor:"bg-green-100"}:a<0?{status:"Expired",color:"text-red-600",bgColor:"bg-red-100"}:a<=3?{status:`${a} days left`,color:"text-red-600",bgColor:"bg-red-100"}:a<=7?{status:`${a} days left`,color:"text-yellow-600",bgColor:"bg-yellow-100"}:{status:`${a} days left`,color:"text-green-600",bgColor:"bg-green-100"};function Rr(){var Ft,Mt,Vt,Bt;const[,a]=ts(),{user:t,logout:n}=ca(),{toast:r}=gt(),i=ft(),[o,l]=S.useState(!1),[c,m]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(""),[v,y]=S.useState("all"),[w,A]=S.useState(null),[p,b]=S.useState(""),[R,N]=S.useState(!1),[j,_]=S.useState(1),[$]=S.useState(10),[x,J]=S.useState(null),[X,Y]=S.useState(!1),[M,Z]=S.useState(!1),[ie,ee]=S.useState(!1),[q,He]=S.useState(null);S.useEffect(()=>{t&&t.role!=="admin"&&t.role!=="super_admin"&&(r({title:"Access Denied",description:"You do not have permission to access this page.",variant:"destructive"}),a("/"))},[t,a,r]),S.useEffect(()=>{t||a("/admin/login?unauthorized=true")},[t,a]);const Q=Ge({resolver:Xe(dr),defaultValues:{username:"",email:"",password:"",role:"user",firstName:"",lastName:"",phone:"",avatar:"",waveBalance:10,expiresAt:"",isVerified:!1,allowedLanguages:["en"]}}),W=Ge({resolver:Xe(mr),defaultValues:{username:"",email:"",password:"",role:"user",firstName:"",lastName:"",phone:"",avatar:"",waveBalance:0,expiresAt:"",isVerified:!1,allowedLanguages:["en"]}}),Ne=Ge({resolver:Xe(xr),defaultValues:{toCurrency:"IQD",rate:0,isActive:!0}}),we=Ge({resolver:Xe(hr),defaultValues:{rate:0,isActive:!0}}),{data:_t=[],isLoading:Ta}=ir(),yt=lr(),vt=or(),Tt=cr(),Rt=s=>{var C;const h=(C=s.target.files)==null?void 0:C[0];if(h){if(h.size>5242880){r({title:"File too large",description:"Please select an image smaller than 5MB",variant:"destructive"}),s.target.value="";return}if(!h.type.startsWith("image/")){r({title:"Invalid file type",description:"Please select an image file",variant:"destructive"}),s.target.value="";return}A(h);const H=new FileReader;H.onloadend=()=>{const G=H.result;b(G),Q.setValue("avatar",G),W.setValue("avatar",G)},H.readAsDataURL(h)}},Ae=()=>{A(null),b(""),Q.setValue("avatar",""),W.setValue("avatar","")},{data:Le=[],isLoading:Ra}=je({queryKey:["/api/admin/users"],enabled:(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin"}),{data:$t=[],isLoading:ur}=je({queryKey:["/api/admin/users/with-passwords"],enabled:((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin")&&R,retry:!1}),{data:pe=[],isLoading:$a}=je({queryKey:["/api/users",x==null?void 0:x.id,"properties"],enabled:!!(x!=null&&x.id),retry:!1}),jt=Pe({mutationFn:async s=>{const h={...s};if(s.expiresAt&&s.expiresAt.trim()!==""){const V=new Date(s.expiresAt);isNaN(V.getTime())?delete h.expiresAt:h.expiresAt=s.expiresAt}else delete h.expiresAt;return(t==null?void 0:t.role)!=="super_admin"&&delete h.allowedLanguages,await(await be("POST","/api/admin/users",h)).json()},onSuccess:()=>{i.invalidateQueries({queryKey:["/api/admin/users"]}),l(!1),Q.reset(),Ae(),r({title:"Success",description:"User created successfully"})},onError:s=>{r({title:"Error",description:s.message||"Failed to create user",variant:"destructive"})}}),bt=Pe({mutationFn:async({id:s,userData:h})=>{const C={...h};if(h.expiresAt&&h.expiresAt.trim()!==""){const H=new Date(h.expiresAt);isNaN(H.getTime())?delete C.expiresAt:C.expiresAt=h.expiresAt}else delete C.expiresAt;return(t==null?void 0:t.role)!=="super_admin"&&delete C.allowedLanguages,await(await be("PUT",`/api/admin/users/${s}`,C)).json()},onSuccess:()=>{i.invalidateQueries({queryKey:["/api/admin/users"]}),m(!1),d(null),W.reset(),Ae(),r({title:"Success",description:"User updated successfully"})},onError:s=>{r({title:"Error",description:s.message||"Failed to update user",variant:"destructive"})}}),Ia=Pe({mutationFn:async s=>await(await be("DELETE",`/api/admin/users/${s}`)).json(),onSuccess:()=>{i.invalidateQueries({queryKey:["/api/admin/users"]}),r({title:"Success",description:"User deleted successfully"})},onError:s=>{r({title:"Error",description:s.message||"Failed to delete user",variant:"destructive"})}}),Ua=async()=>{try{await n(),a("/admin/login")}catch{r({title:"Error",description:"Logout failed",variant:"destructive"})}},Fa=async s=>{await jt.mutateAsync(s)},Ma=async s=>{u&&await bt.mutateAsync({id:u.id,userData:s})},Va=s=>{d(s);const h=$t.find(H=>H.id===s.id),C=(h==null?void 0:h.password)||"";let V="";s.expiresAt&&(V=new Date(s.expiresAt).toISOString().slice(0,16)),W.reset({username:s.username,email:s.email,password:C,role:s.role,firstName:s.firstName||"",lastName:s.lastName||"",phone:s.phone||"",avatar:s.avatar||"",waveBalance:s.waveBalance||0,expiresAt:V,isVerified:s.isVerified||!1,allowedLanguages:s.allowedLanguages||["en"]}),b(s.avatar||""),m(!0)},Ba=async s=>{await yt.mutateAsync({toCurrency:s.toCurrency,rate:s.rate.toString(),isActive:s.isActive??!1}),Z(!1),Ne.reset()},Ka=async s=>{q&&(await vt.mutateAsync({id:q.id,data:{rate:s.rate.toString(),isActive:s.isActive??!1}}),ee(!1),He(null),we.reset())},za=s=>{He(s),we.reset({rate:Number(s.rate),isActive:s.isActive||!1}),ee(!0)},qa=async s=>{confirm("Are you sure you want to deactivate this currency rate? This action cannot be undone.")&&await Tt.mutateAsync(s)},Wa=async(s,h)=>{window.confirm(`Are you sure you want to delete user "${h}"?`)&&await Ia.mutateAsync(s)},Ha=s=>{J(s),Y(!0)};S.useEffect(()=>{_(1)},[f,v]);const De=Le.filter(s=>{const h=!f||s.username.toLowerCase().includes(f.toLowerCase())||s.email.toLowerCase().includes(f.toLowerCase())||s.firstName&&s.firstName.toLowerCase().includes(f.toLowerCase())||s.lastName&&s.lastName.toLowerCase().includes(f.toLowerCase()),C=v==="all"||s.role===v;return h&&C}),Ce=Math.ceil(De.length/$),Nt=(j-1)*$,It=Nt+$,Ut=De.slice(Nt,It),Qa=De.length>$,Qe={totalUsers:Le.length,agents:Le.filter(s=>s.role==="agent").length,customers:Le.filter(s=>s.role==="user").length,admins:Le.filter(s=>s.role==="admin").length};return!t||t.role!=="admin"&&t.role!=="super_admin"?null:e.jsxs("div",{className:"min-h-screen bg-orange-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-gradient-to-r from-orange-600 to-orange-700 dark:from-orange-800 dark:to-orange-900 shadow-lg border-b border-orange-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center py-4 sm:py-6 space-y-3 sm:space-y-0",children:[e.jsx("div",{className:"flex items-center justify-center sm:justify-start space-x-2 sm:space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-2 bg-white/10 rounded-lg",children:e.jsx(it,{className:"h-6 w-6 sm:h-8 sm:w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white",children:"Admin Dashboard"}),e.jsx("p",{className:"text-xs sm:text-sm text-orange-100 hidden sm:block",children:"Estate Management System"})]})]})}),e.jsxs("div",{className:"flex items-center justify-center sm:justify-end space-x-2 sm:space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 bg-white/10 rounded-lg px-2 sm:px-3 py-1 sm:py-2",children:[e.jsxs(Ue,{className:"h-8 w-8 sm:h-10 sm:w-10",children:[e.jsx(Fe,{src:t.avatar||""}),e.jsxs(Me,{className:"bg-white text-orange-600 font-medium",children:[(Ft=t.firstName)==null?void 0:Ft[0],((Mt=t.lastName)==null?void 0:Mt[0])||t.username[0]]})]}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:t.username}),e.jsx("p",{className:"text-xs text-orange-100",children:"Super Administrator"})]})]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:Ua,className:"bg-white/10 border-white/20 text-white hover:bg-white hover:text-orange-600 transition-all duration-200","data-testid":"button-logout",children:[e.jsx(xs,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-4 sm:py-6 lg:py-8",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-6 sm:mb-8",children:[e.jsxs(U,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2 p-3 sm:p-4",children:[e.jsx(z,{className:"text-xs sm:text-sm font-medium text-orange-100",children:"Total Users"}),e.jsx("div",{className:"p-1 sm:p-2 bg-white/20 rounded-lg",children:e.jsx(nt,{className:"h-3 w-3 sm:h-4 sm:w-4 text-white"})})]}),e.jsxs(F,{className:"p-3 sm:p-4 pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-white",children:Qe.totalUsers}),e.jsx("p",{className:"text-xs text-orange-100 mt-1 hidden sm:block",children:"Active accounts"})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-orange-400 to-orange-500 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2 p-3 sm:p-4",children:[e.jsx(z,{className:"text-xs sm:text-sm font-medium text-orange-100",children:"Agents"}),e.jsx("div",{className:"p-1 sm:p-2 bg-white/20 rounded-lg",children:e.jsx(kt,{className:"h-3 w-3 sm:h-4 sm:w-4 text-white"})})]}),e.jsxs(F,{className:"p-3 sm:p-4 pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-white",children:Qe.agents}),e.jsx("p",{className:"text-xs text-orange-100 mt-1 hidden sm:block",children:"Real estate professionals"})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-orange-300 to-orange-400 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2 p-3 sm:p-4",children:[e.jsx(z,{className:"text-xs sm:text-sm font-medium text-orange-100",children:"Customers"}),e.jsx("div",{className:"p-1 sm:p-2 bg-white/20 rounded-lg",children:e.jsx(nt,{className:"h-3 w-3 sm:h-4 sm:w-4 text-white"})})]}),e.jsxs(F,{className:"p-3 sm:p-4 pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-white",children:Qe.customers}),e.jsx("p",{className:"text-xs text-orange-100 mt-1 hidden sm:block",children:"Property seekers"})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-orange-600 to-orange-700 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2 p-3 sm:p-4",children:[e.jsx(z,{className:"text-xs sm:text-sm font-medium text-orange-100",children:"Admins"}),e.jsx("div",{className:"p-1 sm:p-2 bg-white/20 rounded-lg",children:e.jsx(it,{className:"h-3 w-3 sm:h-4 sm:w-4 text-white"})})]}),e.jsxs(F,{className:"p-3 sm:p-4 pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-white",children:Qe.admins}),e.jsx("p",{className:"text-xs text-orange-100 mt-1 hidden sm:block",children:"System administrators"})]})]})]}),e.jsxs(U,{className:"shadow-lg border-0 bg-white dark:bg-gray-800",children:[e.jsx(K,{className:"border-b border-orange-100 dark:border-gray-700 bg-gradient-to-r from-orange-50 to-white dark:from-gray-800 dark:to-gray-800",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx(z,{className:"text-lg sm:text-xl text-orange-800 dark:text-orange-200 font-bold",children:"User Management"}),e.jsx(de,{className:"text-orange-600 dark:text-orange-300 mt-1",children:"Manage real estate agencies, agents, and customers"})]}),e.jsxs(_e,{open:o,onOpenChange:s=>{l(s),s||Ae()},children:[e.jsx(Wt,{asChild:!0,children:e.jsxs(B,{className:"bg-orange-600 hover:bg-orange-700 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200 w-full sm:w-auto","data-testid":"button-create-user",children:[e.jsx(St,{className:"h-4 w-4 mr-2"}),"Create User"]})}),e.jsxs(Te,{className:"w-[95vw] max-w-[95vw] sm:max-w-lg md:max-w-xl lg:max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Re,{children:[e.jsx($e,{children:"Create New User"}),e.jsx(Ie,{children:"Add a new user to the system"})]}),e.jsx(Ye,{...Q,children:e.jsxs("form",{onSubmit:Q.handleSubmit(Fa),className:"space-y-4",children:[e.jsx(E,{control:Q.control,name:"username",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Username"}),e.jsx(D,{children:e.jsx(I,{...s,"data-testid":"input-username"})}),e.jsx(T,{})]})}),e.jsx(E,{control:Q.control,name:"email",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Email"}),e.jsx(D,{children:e.jsx(I,{...s,type:"email","data-testid":"input-email"})}),e.jsx(T,{})]})}),e.jsx(E,{control:Q.control,name:"avatar",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Profile Photo"}),e.jsx(D,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Ue,{className:"h-16 w-16",children:[e.jsx(Fe,{src:p}),e.jsx(Me,{children:e.jsx(St,{className:"h-8 w-8 text-gray-400"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(I,{type:"file",accept:"image/*",onChange:Rt,className:"cursor-pointer","data-testid":"input-avatar"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload a profile photo (optional, max 5MB)"})]})]})})}),e.jsx(T,{})]})}),e.jsx(E,{control:Q.control,name:"password",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Password"}),e.jsx(D,{children:e.jsx(I,{...s,type:"password","data-testid":"input-password"})}),e.jsx(T,{})]})}),e.jsx(E,{control:Q.control,name:"role",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Role"}),e.jsxs(Je,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(D,{children:e.jsx(Ze,{"data-testid":"select-role",children:e.jsx(et,{placeholder:"Select a role"})})}),e.jsxs(tt,{children:[e.jsx(te,{value:"user",children:"Customer"}),e.jsx(te,{value:"agent",children:"Real Estate Agent"}),e.jsx(te,{value:"admin",children:"Administrator"})]})]}),e.jsx(T,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{control:Q.control,name:"firstName",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"First Name"}),e.jsx(D,{children:e.jsx(I,{...s,"data-testid":"input-firstname"})}),e.jsx(T,{})]})}),e.jsx(E,{control:Q.control,name:"lastName",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Last Name"}),e.jsx(D,{children:e.jsx(I,{...s,"data-testid":"input-lastname"})}),e.jsx(T,{})]})})]}),e.jsx(E,{control:Q.control,name:"phone",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Phone"}),e.jsx(D,{children:e.jsx(I,{...s,"data-testid":"input-phone"})}),e.jsx(T,{})]})}),e.jsx(E,{control:Q.control,name:"waveBalance",render:({field:s})=>e.jsxs(O,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-4 w-4 text-blue-500"}),"Wave Balance"]}),e.jsx(D,{children:e.jsx(I,{...s,type:"number",min:"0","data-testid":"input-wave-balance",className:"border-blue-200 focus:border-blue-500 focus:ring-blue-500",onChange:h=>s.onChange(parseInt(h.target.value)||0)})}),e.jsx(T,{}),e.jsx("p",{className:"text-sm text-gray-500",children:"Number of waves this user can assign to their properties (0 = unlimited for admin)"})]})}),e.jsx(E,{control:Q.control,name:"expiresAt",render:({field:s})=>e.jsxs(O,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"h-4 w-4 text-orange-500"}),"Account Expiration Date"]}),e.jsx(D,{children:e.jsx(I,{...s,type:"datetime-local","data-testid":"input-expires-at",className:"border-orange-200 focus:border-orange-500 focus:ring-orange-500"})}),e.jsx(T,{}),e.jsx("p",{className:"text-sm text-gray-500",children:"Leave empty for no expiration. User account will be automatically disabled after this date."})]})}),e.jsx(E,{control:Q.control,name:"isVerified",render:({field:s})=>e.jsxs(O,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border border-orange-200 p-4",children:[e.jsx(D,{children:e.jsx(fe,{checked:s.value,onCheckedChange:s.onChange,"data-testid":"checkbox-verified"})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(L,{className:"flex items-center gap-2 text-orange-600 font-medium",children:[e.jsx(it,{className:"h-4 w-4"}),"Verified Customer"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Grant this customer the orange verified badge. Verified customers are trusted and receive priority support."})]})]})}),(t==null?void 0:t.role)==="super_admin"&&e.jsx(E,{control:Q.control,name:"allowedLanguages",render:({field:s})=>e.jsxs(O,{className:"rounded-md border border-blue-200 p-4",children:[e.jsxs(L,{className:"flex items-center gap-2 text-blue-600 font-medium",children:[e.jsx(Zt,{className:"h-4 w-4"}),"Language Permissions"]}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Select which languages this customer can use to create content"}),e.jsx("div",{className:"flex flex-wrap gap-4",children:ht.map(h=>{var C;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fe,{checked:((C=s.value)==null?void 0:C.includes(h))||!1,onCheckedChange:V=>{const H=s.value||["en"];if(V)s.onChange([...H,h]);else{const G=H.filter(ce=>ce!==h);G.length===0?s.onChange(["en"]):s.onChange(G)}},"data-testid":`checkbox-language-${h}`}),e.jsx("label",{className:"text-sm font-medium cursor-pointer",onClick:()=>{const V=s.value||["en"];if(!V.includes(h))s.onChange([...V,h]);else{const G=V.filter(ce=>ce!==h);G.length===0?s.onChange(["en"]):s.onChange(G)}},children:Ht[h]})]},h)})})]})}),e.jsx(T,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>{l(!1),Ae()},"data-testid":"button-cancel",children:"Cancel"}),e.jsx(B,{type:"submit",disabled:jt.isPending,"data-testid":"button-submit",children:jt.isPending?"Creating...":"Create User"})]})]})})]})]}),e.jsx(_e,{open:c,onOpenChange:s=>{m(s),s||(d(null),Ae())},children:e.jsxs(Te,{className:"w-[95vw] max-w-[95vw] sm:max-w-lg md:max-w-xl lg:max-w-2xl xl:max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Re,{children:[e.jsx($e,{children:"Edit User"}),e.jsx(Ie,{children:"Update user information"})]}),e.jsx(Ye,{...W,children:e.jsxs("form",{onSubmit:W.handleSubmit(Ma),className:"space-y-4",children:[e.jsx(E,{control:W.control,name:"username",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Username"}),e.jsx(D,{children:e.jsx(I,{...s,"data-testid":"edit-input-username"})}),e.jsx(T,{})]})}),e.jsx(E,{control:W.control,name:"email",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Email"}),e.jsx(D,{children:e.jsx(I,{...s,type:"email","data-testid":"edit-input-email"})}),e.jsx(T,{})]})}),e.jsx(E,{control:W.control,name:"avatar",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Profile Photo"}),e.jsx(D,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Ue,{className:"h-16 w-16",children:[e.jsx(Fe,{src:p}),e.jsx(Me,{children:e.jsx(St,{className:"h-8 w-8 text-gray-400"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(I,{type:"file",accept:"image/*",onChange:Rt,className:"cursor-pointer","data-testid":"edit-input-avatar"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload a profile photo (optional, max 5MB)"})]})]})})}),e.jsx(T,{})]})}),e.jsx(E,{control:W.control,name:"password",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Password (Leave blank to keep current)"}),e.jsx(D,{children:e.jsx(I,{...s,type:"password","data-testid":"edit-input-password",placeholder:"Enter new password"})}),e.jsx(T,{})]})}),e.jsx(E,{control:W.control,name:"role",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Role"}),e.jsxs(Je,{onValueChange:s.onChange,value:s.value,children:[e.jsx(D,{children:e.jsx(Ze,{"data-testid":"edit-select-role",children:e.jsx(et,{placeholder:"Select a role"})})}),e.jsxs(tt,{children:[e.jsx(te,{value:"user",children:"Customer"}),e.jsx(te,{value:"agent",children:"Real Estate Agent"}),e.jsx(te,{value:"admin",children:"Administrator"})]})]}),e.jsx(T,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{control:W.control,name:"firstName",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"First Name"}),e.jsx(D,{children:e.jsx(I,{...s,"data-testid":"edit-input-firstname"})}),e.jsx(T,{})]})}),e.jsx(E,{control:W.control,name:"lastName",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Last Name"}),e.jsx(D,{children:e.jsx(I,{...s,"data-testid":"edit-input-lastname"})}),e.jsx(T,{})]})})]}),e.jsx(E,{control:W.control,name:"phone",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Phone"}),e.jsx(D,{children:e.jsx(I,{...s,"data-testid":"edit-input-phone"})}),e.jsx(T,{})]})}),e.jsx(E,{control:W.control,name:"waveBalance",render:({field:s})=>e.jsxs(O,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-4 w-4 text-blue-500"}),"Wave Balance"]}),e.jsx(D,{children:e.jsx(I,{...s,type:"number",min:"0","data-testid":"edit-input-wave-balance",className:"border-blue-200 focus:border-blue-500 focus:ring-blue-500",onChange:h=>s.onChange(parseInt(h.target.value)||0)})}),e.jsx(T,{}),e.jsx("p",{className:"text-sm text-gray-500",children:"Number of waves this user can assign to their properties (0 = unlimited for admin)"})]})}),e.jsx(E,{control:W.control,name:"expiresAt",render:({field:s})=>e.jsxs(O,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"h-4 w-4 text-orange-500"}),"Account Expiration Date"]}),e.jsx(D,{children:e.jsx(I,{...s,type:"datetime-local","data-testid":"edit-input-expires-at",className:"border-orange-200 focus:border-orange-500 focus:ring-orange-500"})}),e.jsx(T,{}),e.jsx("p",{className:"text-sm text-gray-500",children:"Leave empty for no expiration. User account will be automatically disabled after this date."})]})}),e.jsx(E,{control:W.control,name:"isVerified",render:({field:s})=>e.jsxs(O,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border border-orange-200 p-4",children:[e.jsx(D,{children:e.jsx(fe,{checked:s.value,onCheckedChange:s.onChange,"data-testid":"edit-checkbox-verified"})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(L,{className:"flex items-center gap-2 text-orange-600 font-medium",children:[e.jsx(it,{className:"h-4 w-4"}),"Verified Customer"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Grant this customer the orange verified badge. Verified customers are trusted and receive priority support."})]})]})}),(t==null?void 0:t.role)==="super_admin"&&e.jsx(E,{control:W.control,name:"allowedLanguages",render:({field:s})=>e.jsxs(O,{className:"rounded-md border border-blue-200 p-4",children:[e.jsxs(L,{className:"flex items-center gap-2 text-blue-600 font-medium",children:[e.jsx(Zt,{className:"h-4 w-4"}),"Language Permissions"]}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Select which languages this customer can use to create content"}),e.jsx("div",{className:"flex flex-wrap gap-4",children:ht.map(h=>{var C;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fe,{checked:((C=s.value)==null?void 0:C.includes(h))||!1,onCheckedChange:V=>{const H=s.value||["en"];if(V)s.onChange([...H,h]);else{const G=H.filter(ce=>ce!==h);G.length===0?s.onChange(["en"]):s.onChange(G)}},"data-testid":`edit-checkbox-language-${h}`}),e.jsx("label",{className:"text-sm font-medium cursor-pointer",onClick:()=>{const V=s.value||["en"];if(!V.includes(h))s.onChange([...V,h]);else{const G=V.filter(ce=>ce!==h);G.length===0?s.onChange(["en"]):s.onChange(G)}},children:Ht[h]})]},h)})})]})}),e.jsx(T,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>{m(!1),d(null),Ae()},"data-testid":"edit-button-cancel",children:"Cancel"}),e.jsx(B,{type:"submit",disabled:bt.isPending,"data-testid":"edit-button-submit",children:bt.isPending?"Updating...":"Update User"})]})]})})]})})]})}),e.jsxs(F,{children:[e.jsx("div",{className:"space-y-3 sm:space-y-4 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-orange-400 h-4 w-4"}),e.jsx(I,{placeholder:"Search users...",value:f,onChange:s=>g(s.target.value),className:"pl-10 border-orange-200 focus:border-orange-500 focus:ring-orange-500","data-testid":"input-search"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsxs(Je,{value:v,onValueChange:y,children:[e.jsx(Ze,{className:"w-full sm:w-48 border-orange-200 focus:border-orange-500 focus:ring-orange-500","data-testid":"select-role-filter",children:e.jsx(et,{placeholder:"Filter by role"})}),e.jsxs(tt,{children:[e.jsx(te,{value:"all",children:"All Roles"}),e.jsx(te,{value:"user",children:"Customers"}),e.jsx(te,{value:"agent",children:"Agents"}),e.jsx(te,{value:"admin",children:"Admins"})]})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin")&&e.jsxs(B,{variant:R?"default":"outline",onClick:()=>N(!R),className:`flex items-center gap-2 w-full sm:w-auto transition-all duration-200 ${R?"bg-orange-600 hover:bg-orange-700 text-white":"border-orange-300 text-orange-600 hover:bg-orange-50"}`,"data-testid":"button-toggle-passwords",children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:R?"Hide Passwords":"Show Passwords"})]})]})]})}),e.jsx("div",{className:"border border-orange-200 rounded-lg overflow-hidden",children:Ra?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{children:"Loading users..."})]}):Ut.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(nt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No users found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-orange-100 to-orange-50 dark:from-gray-800 dark:to-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-semibold text-orange-800 dark:text-orange-200 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-semibold text-orange-800 dark:text-orange-200 uppercase tracking-wider hidden sm:table-cell",children:"Role"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-semibold text-orange-800 dark:text-orange-200 uppercase tracking-wider hidden md:table-cell",children:"Status"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-semibold text-orange-800 dark:text-orange-200 uppercase tracking-wider hidden lg:table-cell",children:"Expiration"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin")&&R&&e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-semibold text-orange-800 dark:text-orange-200 uppercase tracking-wider hidden lg:table-cell",children:"Password"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-semibold text-orange-800 dark:text-orange-200 uppercase tracking-wider hidden lg:table-cell",children:"Created"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-right text-xs font-semibold text-orange-800 dark:text-orange-200 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:Ut.map(s=>{var h,C,V;return e.jsxs("tr",{"data-testid":`user-row-${s.id}`,className:"hover:bg-orange-50/50 dark:hover:bg-gray-800/50 transition-colors duration-150",children:[e.jsx("td",{className:"px-3 sm:px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsxs(Ue,{className:"h-8 w-8 sm:h-10 sm:w-10 ring-2 ring-orange-200",children:[e.jsx(Fe,{src:s.avatar||""}),e.jsxs(Me,{className:"bg-orange-100 text-orange-700 font-medium",children:[(h=s.firstName)==null?void 0:h[0],((C=s.lastName)==null?void 0:C[0])||s.username[0]]})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.username}),e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 truncate",children:s.email}),e.jsxs("div",{className:"sm:hidden mt-1 flex items-center space-x-2",children:[e.jsx(se,{variant:s.role==="admin"?"destructive":s.role==="agent"?"default":"secondary",className:"text-xs","data-testid":`badge-role-${s.id}`,children:s.role==="agent"?"Agent":s.role==="admin"?"Admin":"Customer"}),e.jsx(se,{variant:s.isVerified?"default":"secondary",className:`text-xs md:hidden ${s.isVerified?"bg-orange-100 text-orange-800 hover:bg-orange-200":"bg-yellow-100 text-yellow-800 hover:bg-yellow-200"}`,"data-testid":`badge-status-${s.id}`,children:s.isVerified?"Verified":"Unverified"})]})]})]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap hidden sm:table-cell",children:e.jsx(se,{variant:s.role==="admin"?"destructive":s.role==="agent"?"default":"secondary",className:"bg-gradient-to-r text-xs font-medium","data-testid":`badge-role-${s.id}`,children:s.role==="agent"?"Real Estate Agent":s.role==="admin"?"Administrator":"Customer"})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap hidden md:table-cell",children:e.jsx(se,{variant:s.isVerified?"default":"secondary",className:`text-xs font-medium ${s.isVerified?"bg-orange-100 text-orange-800 hover:bg-orange-200 border-orange-300":"bg-yellow-100 text-yellow-800 hover:bg-yellow-200"}`,"data-testid":`badge-status-${s.id}`,children:s.isVerified?"Verified":"Pending"})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap hidden lg:table-cell",children:(()=>{const H=ia(s.expiresAt),{status:G,color:ce,bgColor:Ga}=la(H);return e.jsx(se,{className:`text-xs font-medium ${ce} ${Ga} border-0`,"data-testid":`badge-expiration-${s.id}`,children:G})})()}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin")&&R&&e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500 hidden lg:table-cell",children:e.jsx("code",{className:"bg-orange-50 dark:bg-gray-800 text-orange-700 dark:text-orange-300 px-2 py-1 rounded text-xs border border-orange-200",children:((V=$t.find(H=>H.id===s.id))==null?void 0:V.password)||"••••••••"})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500 hidden lg:table-cell",children:e.jsx("div",{className:"text-xs",children:s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A"})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex gap-1 sm:gap-2 justify-end",children:[e.jsx(B,{variant:"outline",size:"sm",onClick:()=>Ha(s),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 border-blue-200 p-1 sm:p-2","data-testid":`button-view-${s.id}`,children:e.jsx(ba,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin")&&e.jsx(B,{variant:"outline",size:"sm",onClick:()=>Va(s),className:"text-orange-600 hover:text-orange-700 hover:bg-orange-50 border-orange-200 p-1 sm:p-2","data-testid":`button-edit-${s.id}`,children:e.jsx(Qt,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),s.id!==t.id&&e.jsx(B,{variant:"outline",size:"sm",onClick:()=>Wa(s.id,s.username),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200 p-1 sm:p-2","data-testid":`button-delete-${s.id}`,children:e.jsx(Gt,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]})})]},s.id)})})]})})}),Qa&&e.jsx("div",{className:"mt-6 px-4 py-3 bg-white dark:bg-gray-800 border-t border-orange-200 dark:border-gray-700 rounded-b-lg",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing ",Nt+1," to ",Math.min(It,De.length)," of ",De.length," users"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{variant:"outline",size:"sm",onClick:()=>_(Math.max(1,j-1)),disabled:j===1,className:"text-orange-600 border-orange-200 hover:bg-orange-50","data-testid":"button-prev-page",children:"Previous"}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,Ce)},(s,h)=>{let C;return Ce<=5||j<=3?C=h+1:j>=Ce-2?C=Ce-4+h:C=j-2+h,e.jsx(B,{variant:j===C?"default":"outline",size:"sm",onClick:()=>_(C),className:`w-8 h-8 p-0 ${j===C?"bg-orange-600 text-white hover:bg-orange-700":"text-orange-600 border-orange-200 hover:bg-orange-50"}`,"data-testid":`button-page-${C}`,children:C},C)})}),e.jsx(B,{variant:"outline",size:"sm",onClick:()=>_(Math.min(Ce,j+1)),disabled:j===Ce,className:"text-orange-600 border-orange-200 hover:bg-orange-50","data-testid":"button-next-page",children:"Next"})]})]})})]})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin")&&e.jsxs(U,{className:"shadow-lg border-0 bg-white dark:bg-gray-800 mt-8",children:[e.jsx(K,{className:"border-b border-orange-100 dark:border-gray-700 bg-gradient-to-r from-orange-50 to-white dark:from-gray-800 dark:to-gray-800",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx(z,{className:"text-lg sm:text-xl text-orange-800 dark:text-orange-200 font-bold",children:"Currency Exchange Rates"}),e.jsx(de,{className:"text-orange-600 dark:text-orange-300 mt-1",children:"Manage USD exchange rates for supported currencies (IQD, EUR, AED)"})]}),e.jsxs(_e,{open:M,onOpenChange:Z,children:[e.jsx(Wt,{asChild:!0,children:e.jsxs(B,{className:"bg-orange-600 hover:bg-orange-700 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200 w-full sm:w-auto","data-testid":"button-create-currency-rate",children:[e.jsx(ya,{className:"h-4 w-4 mr-2"}),"Add Exchange Rate"]})}),e.jsxs(Te,{className:"sm:max-w-md",children:[e.jsxs(Re,{children:[e.jsx($e,{children:"Add New Exchange Rate"}),e.jsx(Ie,{children:"Set the exchange rate from 1 USD to the target currency"})]}),e.jsx(Ye,{...Ne,children:e.jsxs("form",{onSubmit:Ne.handleSubmit(Ba),className:"space-y-6",children:[e.jsx(E,{control:Ne.control,name:"toCurrency",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Target Currency"}),e.jsxs(Je,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(D,{children:e.jsx(Ze,{"data-testid":"select-currency",children:e.jsx(et,{placeholder:"Select target currency"})})}),e.jsxs(tt,{children:[e.jsx(te,{value:"IQD",children:"Iraqi Dinar (IQD)"}),e.jsx(te,{value:"EUR",children:"Euro (EUR)"}),e.jsx(te,{value:"AED",children:"UAE Dirham (AED)"})]})]}),e.jsx(T,{})]})}),e.jsx(E,{control:Ne.control,name:"rate",render:({field:s})=>e.jsxs(O,{children:[e.jsx(L,{children:"Exchange Rate (1 USD =)"}),e.jsx(D,{children:e.jsx(I,{...s,type:"number",step:"0.000001",placeholder:"e.g., 1173.5","data-testid":"input-exchange-rate",onChange:h=>s.onChange(parseFloat(h.target.value)||0)})}),e.jsx(T,{})]})}),e.jsx(E,{control:Ne.control,name:"isActive",render:({field:s})=>e.jsxs(O,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(L,{className:"text-base",children:"Active Rate"}),e.jsx(qt,{children:"Make this rate active for user transactions"})]}),e.jsx(D,{children:e.jsx(fe,{checked:s.value??!1,onCheckedChange:s.onChange,"data-testid":"checkbox-is-active"})})]})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>Z(!1),"data-testid":"button-cancel-create",children:"Cancel"}),e.jsx(B,{type:"submit",disabled:yt.isPending,"data-testid":"button-submit-create",children:yt.isPending?"Creating...":"Add Rate"})]})]})})]})]})]})}),e.jsx(F,{className:"p-6",children:Ta?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"})}):_t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(As,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No currency exchange rates configured yet."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-orange-200 dark:border-gray-600",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300",children:"From"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300",children:"To"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300",children:"Exchange Rate"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300",children:"Last Updated"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700 dark:text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:_t.map(s=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700 hover:bg-orange-25 dark:hover:bg-gray-750","data-testid":`row-currency-rate-${s.id}`,children:[e.jsx("td",{className:"py-4 px-4 font-medium",children:s.fromCurrency}),e.jsx("td",{className:"py-4 px-4 font-medium",children:s.toCurrency}),e.jsx("td",{className:"py-4 px-4 font-mono text-lg",children:Number(s.rate).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:6})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx(se,{variant:s.isActive?"default":"secondary",className:s.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","data-testid":`badge-status-${s.id}`,children:s.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-500",children:new Date(s.updatedAt||s.createdAt||new Date).toLocaleDateString()}),e.jsxs("td",{className:"py-4 px-4 text-right space-x-2",children:[e.jsx(B,{variant:"outline",size:"sm",onClick:()=>za(s),className:"text-orange-600 border-orange-200 hover:bg-orange-50","data-testid":`button-edit-${s.id}`,children:e.jsx(Qt,{className:"h-4 w-4"})}),e.jsx(B,{variant:"outline",size:"sm",onClick:()=>qa(s.id),disabled:Tt.isPending,className:"text-red-600 border-red-200 hover:bg-red-50","data-testid":`button-delete-${s.id}`,children:e.jsx(Gt,{className:"h-4 w-4"})})]})]},s.id))})]})})})]}),e.jsx(_e,{open:ie,onOpenChange:ee,children:e.jsxs(Te,{className:"sm:max-w-md",children:[e.jsxs(Re,{children:[e.jsx($e,{children:"Edit Exchange Rate"}),e.jsxs(Ie,{children:["Update the exchange rate from 1 USD to ",q==null?void 0:q.toCurrency]})]}),e.jsx(Ye,{...we,children:e.jsxs("form",{onSubmit:we.handleSubmit(Ka),className:"space-y-6",children:[e.jsx(E,{control:we.control,name:"rate",render:({field:s})=>e.jsxs(O,{children:[e.jsxs(L,{children:["Exchange Rate (1 USD = ",q==null?void 0:q.toCurrency,")"]}),e.jsx(D,{children:e.jsx(I,{...s,type:"number",step:"0.000001",placeholder:"e.g., 1173.5","data-testid":"input-edit-exchange-rate",onChange:h=>s.onChange(parseFloat(h.target.value)||0)})}),e.jsx(T,{})]})}),e.jsx(E,{control:we.control,name:"isActive",render:({field:s})=>e.jsxs(O,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(L,{className:"text-base",children:"Active Rate"}),e.jsx(qt,{children:"Make this rate active for user transactions"})]}),e.jsx(D,{children:e.jsx(fe,{checked:s.value??!1,onCheckedChange:s.onChange,"data-testid":"checkbox-edit-is-active"})})]})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>ee(!1),"data-testid":"button-cancel-edit",children:"Cancel"}),e.jsx(B,{type:"submit",disabled:vt.isPending,"data-testid":"button-submit-edit",children:vt.isPending?"Updating...":"Update Rate"})]})]})})]})}),e.jsx(_e,{open:X,onOpenChange:Y,children:e.jsxs(Te,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Re,{children:[e.jsxs($e,{className:"flex items-center space-x-3",children:[e.jsxs(Ue,{className:"h-12 w-12 ring-2 ring-orange-200",children:[e.jsx(Fe,{src:(x==null?void 0:x.avatar)||""}),e.jsxs(Me,{className:"bg-orange-100 text-orange-700 font-medium text-lg",children:[(Vt=x==null?void 0:x.firstName)==null?void 0:Vt[0],((Bt=x==null?void 0:x.lastName)==null?void 0:Bt[0])||(x==null?void 0:x.username[0])]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:x!=null&&x.firstName&&(x!=null&&x.lastName)?`${x.firstName} ${x.lastName}`:x==null?void 0:x.username}),e.jsx("p",{className:"text-gray-600",children:x==null?void 0:x.email})]})]}),e.jsx(Ie,{children:"Complete customer profile and property portfolio"})]}),x&&e.jsxs(va,{defaultValue:"overview",className:"w-full",children:[e.jsxs(ja,{className:"grid w-full grid-cols-3",children:[e.jsx(ge,{value:"overview",children:"Overview"}),e.jsx(ge,{value:"properties",children:"Properties"}),e.jsx(ge,{value:"analytics",children:"Analytics"})]}),e.jsx(ye,{value:"overview",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(U,{children:[e.jsx(K,{className:"pb-3",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(nt,{className:"h-4 w-4 mr-2"}),"Customer Details"]})}),e.jsxs(F,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Username:"}),e.jsx("span",{className:"font-medium",children:x.username})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Role:"}),e.jsx(se,{variant:x.role==="admin"?"destructive":"secondary",children:x.role==="agent"?"Agent":x.role==="admin"?"Admin":"Customer"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx(se,{variant:x.isVerified?"default":"secondary",className:`${x.isVerified?"bg-orange-100 text-orange-800 hover:bg-orange-200 border-orange-300":"bg-yellow-100 text-yellow-800 hover:bg-yellow-200"}`,children:x.isVerified?"Verified":"Pending"})]}),x.phone&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:x.phone})]})]})]}),e.jsxs(U,{children:[e.jsx(K,{className:"pb-3",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Portfolio Stats"]})}),e.jsxs(F,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Properties:"}),e.jsx("span",{className:"font-bold text-lg text-orange-600",children:pe.length})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"For Sale:"}),e.jsx("span",{className:"font-medium",children:pe.filter(s=>s.listingType==="sale").length})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"For Rent:"}),e.jsx("span",{className:"font-medium",children:pe.filter(s=>s.listingType==="rent").length})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Value:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["$",pe.reduce((s,h)=>s+(h.price||0),0).toLocaleString()]})]})]})]}),e.jsxs(U,{children:[e.jsx(K,{className:"pb-3",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(Ct,{className:"h-4 w-4 mr-2"}),"Account Info"]})}),e.jsxs(F,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Joined:"}),e.jsx("span",{className:"font-medium",children:x.createdAt?new Date(x.createdAt).toLocaleDateString():"N/A"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Expiration:"}),e.jsx("span",{className:"font-medium",children:(()=>{const s=ia(x.expiresAt),{status:h,color:C}=la(s);return e.jsx("span",{className:C,children:h})})()})]})]})]})]})}),e.jsx(ye,{value:"properties",className:"space-y-6 mt-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(z,{className:"flex items-center justify-between",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(kt,{className:"h-5 w-5 mr-2"}),"Properties Portfolio (",pe.length,")"]})})}),e.jsx(F,{children:$a?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full"}),e.jsx("span",{className:"ml-3",children:"Loading properties..."})]}):pe.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(kt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No properties found for this customer"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:pe.map(s=>{var h;return e.jsxs(U,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[s.images&&s.images.length>0?e.jsx("img",{src:s.images[0],alt:s.title,className:"w-full h-32 object-cover"}):e.jsx("div",{className:"w-full h-32 bg-gray-200 flex items-center justify-center",children:e.jsx(us,{className:"h-8 w-8 text-gray-400"})}),e.jsx(se,{className:`absolute top-2 right-2 ${s.listingType==="sale"?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,children:s.listingType==="sale"?"For Sale":"For Rent"})]}),e.jsxs(F,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2 line-clamp-1",children:s.title}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(js,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"line-clamp-1",children:s.location})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:s.type})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ws,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{className:"font-bold text-green-600",children:["$",(h=s.price)==null?void 0:h.toLocaleString()]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.bedrooms,"bd • ",s.bathrooms,"ba"]})]})]})]})]},s.id)})})})]})}),e.jsx(ye,{value:"analytics",className:"mt-6",children:e.jsx(nr,{customerId:x.id,customerName:x.firstName&&x.lastName?`${x.firstName} ${x.lastName}`:x.username})})]})]})})]})]})}export{Rr as default};
